import{_ as D}from"./GameIcon.6da36731.js";import{_ as k,o as r,c,a as o,b as d,t as n,n as z,p as B,f as G,U as K,F as b,r as M,k as C,l as f,d as g,m as ge,q as Y,s as N,v as ee,x as w,y as R,z as te,A as x,B as j,C as y,w as v,D as A,E as Z,j as P,g as pe,L as _e,e as fe,G as ve,I as ye,J as be,K as $e,M as ke,N as we,O as Ee,h as Me,P as Ce}from"./entry.db787e62.js";import{_ as Ie}from"./Alert.a36ea043.js";import{v as X,u as T}from"./useAuthenticatedFetch.5b4a294f.js";import{_ as F}from"./GameButton.8dbdfc1c.js";import{u as De}from"./index.144e6725.js";import{_ as Ne}from"./hitmaps-h.c504b3c5.js";import{_ as Le}from"./hitmaps.abeba6ac.js";import{u as U}from"./fetch.d6edc54b.js";const Se=e=>(B("data-v-a24a1f84"),e=e(),G(),e),Te=["src"],Ae={class:"footer"},Fe={class:"footer-image"},Oe={class:"footer-text"},Ve=Se(()=>o("div",{class:"loader",style:{display:"inline-block",height:"48px",float:"right"}},null,-1)),Re={__name:"SplashScreen",props:["mission"],setup(e){return(t,i)=>{const m=D;return r(),c("div",{class:"overlay",style:z("background: #ccc url("+e.mission.backgroundUrl+") no-repeat; background-size: cover")},[o("div",{class:"overlay-container",style:z(`background: url('${e.mission.tileUrl}') center center / cover no-repeat`)},[o("img",{class:"img-fluid",src:e.mission.tileUrl,alt:"Mission Thumbnail",style:{visibility:"hidden"}},null,8,Te),o("div",Ae,[o("div",Fe,[d(m,{icon:"mission","font-style":"normal"})]),o("div",Oe,[o("h2",null,n(t.$t("mission-types."+e.mission.missionType.toLowerCase(),e.mission.missionType)),1),o("h1",null,n(t.$t("missions."+e.mission.slug,e.mission.name)),1)]),Ve])],4)],4)}}},Pe=k(Re,[["__scopeId","data-v-a24a1f84"]]);const Ue={name:"FloorToggle",props:{mission:Object,currentFloor:Number,nodes:Array,currentVariant:Object},data(){return{floorNames:[],lastFloorType:""}},mounted(){this.buildLevelNames()},methods:{range(e,t){return K.range(e,t)},buildLevelNames(){if(this.mission===void 0){console.error("RIP");return}this.floorNames={};for(var e=this.mission.highestFloorNumber;e>=this.mission.lowestFloorNumber;e--)this.mission.floorNames[e]?this.floorNames[e]={header:this.isNewFloorType(this.$t(this.mission.floorNames[e].nameKey))?this.lastFloorType:void 0,value:this.getFormattedFloorName(this.$t(this.mission.floorNames[e].nameKey))}:this.floorNames[e]={header:void 0,value:this.$t("map.level-number",{levelNumber:e})}},isNewFloorType(e){if(!e.length)return!1;if(!e.includes("|")&&e!==this.lastFloorType)return e!==this.lastFloorType?(this.lastFloorType=e,!0):!1;let t=e.split("|");return t[0]!==this.lastFloorType?(this.lastFloorType=t[0],!0):!1},getFormattedFloorName(e){return e.includes("|")?e.split("|")[1]:e},calculateNumber(e){return this.nodes.filter(t=>t.level===e&&t.visible&&t.variants.includes(this.currentVariant.id)).length},hasSearchResults(e){return this.nodes.some(t=>t.level===e&&t.searchResult)}}},Be={class:"floor-toggle"},Ge={key:0,class:"floor-header"},He={class:"floor-details"},qe=["onClick"],ze={key:0},Ze={class:"floor-details"};function je(e,t,i,m,a,s){return r(),c("div",Be,[(r(!0),c(b,null,M(s.range(i.mission.lowestFloorNumber,i.mission.highestFloorNumber).reverse(),l=>(r(),c("div",{key:l,class:C(["floor-info",{selected:i.currentFloor===l}])},[a.floorNames[l]&&a.floorNames[l].header?(r(),c("div",Ge,[o("span",null,n(a.floorNames[l].header),1)])):f("",!0),o("div",He,[o("div",{onClick:u=>e.$emit("change-floor",l),class:"floor"},[a.floorNames[l]&&a.floorNames[l].value?(r(),c("span",ze,n(a.floorNames[l].value),1)):f("",!0)],8,qe),o("div",{class:C([{"has-search-results":s.hasSearchResults(l)},"item-count"])},n(s.calculateNumber(l)),3)])],2))),128)),i.mission.satelliteView?(r(),c("div",{key:0,class:C(["floor-info text-center",{selected:i.currentFloor===-99}])},[o("div",Ze,[o("div",{onClick:t[0]||(t[0]=l=>e.$emit("change-floor",-99)),class:"floor satellite"},n(e.$t("map.satellite")),1)])],2)):f("",!0)])}const Je=k(Ue,[["render",je],["__scopeId","data-v-45174424"]]);const Qe={name:"EditorHeader",props:{editorState:String}},J=e=>(B("data-v-f1730c33"),e=e(),G(),e),We={class:"editor-enabled"},Ke={key:0},Ye=J(()=>o("i",{class:"fas fa-fw fa-map-marker-alt"},null,-1)),xe={key:1},Xe=J(()=>o("i",{class:"fas fa-fw fa-bezier-curve"},null,-1)),et={key:2},tt=J(()=>o("i",{class:"fas fa-fw fa-leaf"},null,-1)),ot={key:3},it=J(()=>o("i",{class:"fas fa-fw fa-user-tie"},null,-1));function st(e,t,i,m,a,s){return r(),c("div",We,[i.editorState==="ITEMS"?(r(),c("h3",Ke,[Ye,g(" "+n(e.$t("map.add-remove-items")),1)])):i.editorState==="LEDGES"?(r(),c("h3",xe,[Xe,g(" "+n(e.$t("map.add-remove-ledges")),1)])):i.editorState==="FOLIAGE"?(r(),c("h3",et,[tt,g(" "+n(e.$t("map.add-remove-foliage")),1)])):i.editorState==="DISGUISE-REGIONS"?(r(),c("h3",ot,[it,g(" "+n(e.$t("map.manage-disguise-areas")),1)])):f("",!0)])}const at=k(Qe,[["render",st],["__scopeId","data-v-f1730c33"]]);const nt={name:"ControlButton"};function rt(e,t,i,m,a,s){return r(),c("button",Y({class:"btn control-button"},e.$attrs),[ge(e.$slots,"default",{},void 0,!0)],16)}const oe=k(nt,[["render",rt],["__scopeId","data-v-8b58fa36"]]);const lt={name:"MissionVariantSelector",props:{mission:Object,currentVariant:Object,loggedIn:Boolean},data(){return{dropdownClosed:!0}},methods:{getAllVariantsForUser(){return this.loggedIn?this.mission.variants:this.mission.variants.filter(e=>e.visible)},getVariantsToShow(){return this.loggedIn?this.mission.variants.filter(e=>e.id!==this.currentVariant.id):this.mission.variants.filter(e=>e.id!==this.currentVariant.id&&e.visible)},changeVariant(e){this.$refs.variantToggle.click(),this.$emit("variant-selected",e)},toggleDropdownState(){this.dropdownClosed=!this.dropdownClosed}}},dt={key:0,class:"variant-box"},ct={class:"card"},ut={class:"card-header",id:"header-variants"},mt={class:"variant-text"},ht={class:"carets"},gt={id:"body-variants",class:"collapse","aria-labelledby":"header-variants"},pt={class:"card-body variants"},_t={class:"row"},ft={class:"col-12"},vt={class:"variants-header"},yt=["onClick"],bt={class:"variant"},$t={class:"variant-info"};function kt(e,t,i,m,a,s){const l=D,u=N;return s.getAllVariantsForUser().length>1?(r(),c("div",dt,[o("div",ct,[o("div",ut,[o("div",{class:"name collapsed control-button",ref:"variantToggle","data-bs-toggle":"collapse","data-bs-target":"#body-variants","aria-expanded":"false","aria-controls":"body-variants",onClick:t[0]||(t[0]=(...h)=>s.toggleDropdownState&&s.toggleDropdownState(...h))},[d(l,{icon:i.currentVariant.icon,"font-style":"solid"},null,8,["icon"]),o("span",mt,n(i.currentVariant.name),1),o("span",ht,[d(u,{class:"caret-down",name:"fa6-solid:caret-down"}),d(u,{class:"caret-up",name:"fa6-solid:caret-up"})])],512)]),o("div",gt,[o("div",pt,[o("div",_t,[o("div",ft,[o("p",vt,n(e.$t("map.other-variants")),1)]),(r(!0),c(b,null,M(s.getVariantsToShow(),h=>(r(),c("div",{onClick:_=>s.changeVariant(h),key:h.id,class:"col-12"},[o("div",bt,[o("p",$t,[d(l,{icon:h.icon,"font-style":"solid"},null,8,["icon"]),g(" "+n(h.name),1)])])],8,yt))),128))])])])])])):f("",!0)}const wt=k(lt,[["render",kt],["__scopeId","data-v-12ff674a"]]);const Et={name:"ItemSearch",props:{searchableNodes:Object},setup(){return{uuid:X()}},data(){return{id:this.uuid,searchResults:{},searchedItem:null,searchBox:""}},mounted(){this.searchedItem=this.$route.query.item??null},computed:{searchDropdownText(){if(!this.searchedItem)return this.$t("map.search");const e=this.searchedItem.split("|");return this.searchableNodes[e[0]].find(t=>t===e[1])}},methods:{onSearch(e,t){this.searchedItem=`${e}|${t}`,this.updateQueryStringParameter()},updateQueryStringParameter(){let e=Object.assign({},this.$route.query,{item:this.searchedItem});this.searchedItem||delete e.item,this.$router.replace({query:e})},clearSearch(){this.searchedItem=null,this.updateQueryStringParameter()},dropdownClose(){this.searchBox=""}},watch:{searchedItem(){this.$emit("search-item",this.searchedItem)},searchBox(){if(!this.searchBox){this.searchResults=this.searchableNodes;return}this.searchResults={};for(const[e,t]of Object.entries(this.searchableNodes))t.filter(m=>m.toLowerCase().includes(this.searchBox.toLowerCase())).length&&(this.searchResults[e]=t.filter(m=>m.toLowerCase().includes(this.searchBox.toLowerCase())))},searchableNodes:{handler(){this.searchResults=this.searchableNodes},immediate:!0}}},Mt=e=>(B("data-v-e04d2154"),e=e(),G(),e),Ct={class:"btn btn-secondary dropdown-toggle control-button",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},It={class:"dropdown-arrow"},Dt={class:"dropdown-menu"},Nt={class:"search-input"},Lt={class:"dropdown-options"},St={class:"dropdown-header"},Tt=["onClick"],At=Mt(()=>o("hr",{class:"dropdown-divider"},null,-1));function Ft(e,t,i,m,a,s){const l=N,u=ee("tooltip");return r(),c("div",{class:C(["search-box",a.searchedItem?"item-selected":""])},[o("div",Y({class:"dropdown bootstrap-select",role:"menu"},te({"hide.bs.dropdown":s.dropdownClose},!0)),[o("button",Ct,[d(l,{class:"magnifier",name:"fa6-solid:magnifying-glass"}),g(" "+n(s.searchDropdownText)+" ",1),o("span",It,[d(l,{name:"fa6-solid:caret-down"})])]),o("div",Dt,[o("div",Nt,[w(o("input",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=h=>a.searchBox=h)},null,512),[[R,a.searchBox]])]),o("div",Lt,[(r(!0),c(b,null,M(a.searchResults,(h,_)=>(r(),c(b,{key:_},[o("h6",St,n(_),1),(r(!0),c(b,null,M(h,E=>(r(),c("a",{key:`${_}|${E}`,class:"dropdown-item",href:"#",onClick:p=>s.onSearch(_,E)},n(E),9,Tt))),128)),At],64))),128))])])],16),w((r(),c("button",{onClick:t[1]||(t[1]=(...h)=>s.clearSearch&&s.clearSearch(...h)),id:"clear-search",class:"btn control-button"},[d(l,{name:"fa6-solid:xmark"})])),[[u,e.$t("map.clear-search"),"top"],[x,a.searchedItem]])],2)}const Ot=k(Et,[["render",Ft],["__scopeId","data-v-e04d2154"]]);const Vt={name:"DisguiseDropdown",props:{game:Object,mission:Object,disguises:Array,currentDisguise:Object},data(){return{cachedDisguiseAreas:[]}},methods:{changeDisguise(e){this.$refs.disguiseToggle.click(),this.$emit("disguise-selected",e)}}},Rt={class:"search-box"},Pt={class:"card"},Ut={class:"card-header",id:"header-disguises"},Bt={class:"name collapsed control-button",ref:"disguiseToggle","data-bs-toggle":"collapse","data-bs-target":"#body-disguises","aria-expanded":"false","aria-controls":"body-digsuies"},Gt={class:"disguise-text"},Ht={class:"carets"},qt={id:"body-disguises",class:"collapse","aria-labelledby":"header-disguises"},zt={class:"card-body disguises"},Zt={class:"row"},jt={class:"disguise",style:{background:"#fff url('https://media.hitmaps.com/img/hitman3/ui/tiles/any_disguise.jpg') center center / auto no-repeat"}},Jt=["onClick"],Qt={key:1,class:"disguise-info"};function Wt(e,t,i,m,a,s){const l=N,u=j("i18n-t");return r(),c("div",Rt,[o("div",Pt,[o("div",Ut,[o("div",Bt,[d(l,{name:"fa6-regular:user"}),o("span",Gt,n(i.currentDisguise===null?e.$t("map.disguises"):i.currentDisguise.name),1),o("span",Ht,[d(l,{class:"caret-down",name:"fa6-solid:caret-down"}),d(l,{class:"caret-up",name:"fa6-solid:caret-up"})])],512)]),o("div",qt,[o("div",zt,[o("div",Zt,[o("div",{class:"col-12",onClick:t[0]||(t[0]=h=>s.changeDisguise("NONE"))},[o("div",jt,[o("p",null,n(e.$t("map.none")),1)])]),(r(!0),c(b,null,M(i.disguises,h=>(r(),c("div",{onClick:_=>s.changeDisguise(h),key:h.id,class:"col-12"},[o("div",{class:"disguise",style:z(`background: url('${h.image}') center 70% / cover no-repeat`)},[h.suit?(r(),y(u,{key:0,keypath:"map.suit-disguise",tag:"p",class:"disguise-info"},{suitName:v(()=>[g(n(h.name),1)]),_:2},1024)):(r(),c("p",Qt,n(h.name),1))],4)],8,Jt))),128))])])])])])}const Kt=k(Vt,[["render",Wt],["__scopeId","data-v-ea256b3f"]]);const Yt={name:"HideSelectAll"},xt={class:"hide-select-all"};function Xt(e,t,i,m,a,s){const l=N,u=oe;return r(),c("div",xt,[d(u,{class:"hide-select-button",onClick:t[0]||(t[0]=h=>e.$emit("hide-all"))},{default:v(()=>[d(l,{name:"fa6-regular:eye-slash"}),g(" "+n(e.$t("map.hide-all")),1)]),_:1}),d(u,{class:"hide-select-button",onClick:t[1]||(t[1]=h=>e.$emit("show-all"))},{default:v(()=>[d(l,{name:"fa6-regular:eye"}),g(" "+n(e.$t("map.show-all")),1)]),_:1})])}const eo=k(Yt,[["render",Xt],["__scopeId","data-v-8ae5db3d"]]);const to={name:"TopLevelCategoryCard",props:{topLevelCategoryName:String,categories:Array,nodes:Array,ledges:Array,foliage:Array},setup(){return{uuid:X()}},data(){return{uid:this.uuid}},methods:{areAllNodesHiddenForTopLevelCategory(){let e=!1;return this.topLevelCategoryName==="Navigation"&&(e=this.ledges.some(t=>t.visible)||this.foliage.some(t=>t.visible)),!e&&!this.nodes.some(t=>t.visible&&!t.searchResult)},onTopLevelClick(){this.areAllNodesHiddenForTopLevelCategory()?this.$emit("show-top-level-category",this.topLevelCategoryName):this.$emit("hide-top-level-category",this.topLevelCategoryName)},onCategoryLevelClick(e){this.getItemsForCategory(e).some(t=>t.visible&&!t.searchResult)?this.$emit("hide-category",e):this.$emit("show-category",e)},isCategoryHidden(e){return e.subgroup==="ledge"?!this.ledges.some(t=>t.visible):e.subgroup==="foliage"?!this.foliage.some(t=>t.visible):!this.nodes.some(t=>t.group===e.group&&t.visible&&!t.searchResult)},buildCollapsibleId(e){const t=e.group.replace(/ /g,"_");return`collapsible-${this.uid}-${t}`},getItemsForCategory(e){return e.subgroup==="ledge"?this.ledges:e.subgroup==="foliage"?this.foliage:this.nodes.filter(t=>t.subgroup===e.subgroup)},noDuplicates:function(e){const t=[];for(let i=0;i<e.length;i++)t.findIndex(m=>m.name===e[i].name)===-1&&t.push(e[i]);return t}}},oo={class:"card"},io=["id"],so=["data-bs-target","aria-controls"],ao={class:"float-right"},no=["id","aria-labelledby"],ro={class:"card-body"},lo={class:"name-and-toggle"},co=["onClick"],uo=["src","alt"],mo=["data-bs-target"],ho=["id"];function go(e,t,i,m,a,s){const l=N;return r(),c("div",oo,[o("div",{class:"card-header",id:`header-${a.uid}`},[o("div",{class:"name collapsed","data-bs-toggle":"collapse","data-bs-target":`#body-${a.uid}`,"aria-expanded":"false","aria-controls":`body-${a.uid}`},[g(n(e.$t(`map.types.${i.topLevelCategoryName}`,i.topLevelCategoryName))+" ",1),o("span",ao,[d(l,{class:"caret-down",name:"fa6-solid:caret-down"}),d(l,{class:"caret-up",name:"fa6-solid:caret-up"})])],8,so),o("div",{class:C(["visibility-toggle group-toggle",{"map-hidden":s.areAllNodesHiddenForTopLevelCategory()}]),onClick:t[0]||(t[0]=(...u)=>s.onTopLevelClick&&s.onTopLevelClick(...u))},[s.areAllNodesHiddenForTopLevelCategory()?(r(),y(l,{key:1,name:"fa6-regular:eye-slash"})):(r(),y(l,{key:0,name:"fa6-regular:eye"}))],2)],8,io),o("div",{id:`body-${a.uid}`,class:"collapse","aria-labelledby":`header-${a.uid}`},[o("div",ro,[(r(!0),c(b,null,M(i.categories,u=>(r(),c("div",{key:u.group,class:C({"full-width":u.collapsible,"half-width":!u.collapsible})},[o("div",lo,[o("div",{class:C(["name",{"map-hidden":s.isCategoryHidden(u)}]),onClick:h=>s.onCategoryLevelClick(u)},[o("img",{src:`/img/map-icons/${u.icon}.png`,alt:`${u.group} Icon`,class:"img-fluid"},null,8,uo),o("span",null,n(e.$t(`map.groups.${i.topLevelCategoryName}|${u.group}`,u.group)),1)],10,co),u.collapsible?(r(),c("div",{key:0,class:"visibility-toggle collapsed","data-bs-toggle":"collapse","data-bs-target":`#${s.buildCollapsibleId(u)}`},[d(l,{class:"caret-up",name:"fa6-solid:caret-up"}),d(l,{class:"caret-down",name:"fa6-solid:caret-down"})],8,mo)):f("",!0)]),u.collapsible?(r(),c("div",{key:0,class:"collapsible-items collapse",id:s.buildCollapsibleId(u)},[o("ul",{style:z({columns:s.getItemsForCategory(u).length>1?2:1})},[(r(!0),c(b,null,M(s.noDuplicates(s.getItemsForCategory(u)),h=>(r(),c("li",{key:h.name},n(h.name),1))),128))],4)],8,ho)):f("",!0)],2))),128))])],8,no)])}const po=k(to,[["render",go],["__scopeId","data-v-a2cdcbe8"]]);const _o={name:"EditLanding",props:{nodesOnly:Boolean}},fo={class:"edit-menu"};function vo(e,t,i,m,a,s){const l=N,u=j("i18n-t");return r(),c("div",fo,[o("h3",null,n(e.$t("map.what-would-you-like-to-do")),1),o("div",{class:"editor-button",onClick:t[0]||(t[0]=h=>e.$emit("launch-editor","ITEMS"))},[o("h3",null,[d(l,{name:"fa6-solid:location-dot"}),g(" "+n(e.$t("map.add-remove-items")),1)])]),i.nodesOnly?f("",!0):(r(),c("div",{key:0,class:"editor-button",onClick:t[1]||(t[1]=h=>e.$emit("launch-editor","LEDGES"))},[o("h3",null,[d(l,{name:"fa6-solid:bezier-curve"}),g(" "+n(e.$t("map.add-remove-ledges")),1)])])),i.nodesOnly?f("",!0):(r(),c("div",{key:1,class:"editor-button",onClick:t[2]||(t[2]=h=>e.$emit("launch-editor","FOLIAGE"))},[o("h3",null,[d(l,{name:"fa6-solid:leaf"}),g(" "+n(e.$t("map.add-remove-foliage")),1)])])),i.nodesOnly?f("",!0):(r(),c("div",{key:2,class:"editor-button",onClick:t[3]||(t[3]=h=>e.$emit("launch-editor","DISGUISE-REGIONS"))},[o("h3",null,[d(l,{name:"fa6-regular:user"}),g(" "+n(e.$t("map.manage-disguise-areas")),1)])])),d(u,{keypath:"map.click-icon-to-close",tag:"p"},{pencilIcon:v(()=>[d(l,{name:"fa6-solid:pencil"})]),_:1})])}const yo=k(_o,[["render",vo],["__scopeId","data-v-294237b2"]]);const bo={name:"EditItems"},$o={class:"items-menu"};function ko(e,t,i,m,a,s){const l=N;return r(),c("div",$o,[o("p",null,[d(l,{name:"fa6-solid:circle-plus"}),g(" "+n(e.$t("map.click-to-add")),1)]),o("p",null,[d(l,{name:"fa6-solid:arrows-up-down-left-right"}),g(" "+n(e.$t("map.drag-to-move")),1)]),o("p",null,[d(l,{name:"fa6-solid:trash"}),g(" "+n(e.$t("map.click-item-to-delete")),1)]),o("div",{class:"editor-button",onClick:t[0]||(t[0]=u=>e.$emit("launch-editor","MENU"))},[o("h3",null,[d(l,{name:"fa6-solid:circle-xmark"}),g(" "+n(e.$t("map.close-item-menu")),1)])])])}const wo=k(bo,[["render",ko],["__scopeId","data-v-7c93c708"]]);const Eo={name:"EditLedges",props:{drawingActive:Boolean}},Mo={class:"ledges-menu"},Co={"data-ledge":"delete-help"};function Io(e,t,i,m,a,s){const l=N;return r(),c("div",Mo,[o("p",Co,[d(l,{name:"fa6-solid:trash"}),g(" "+n(e.$t("map.click-ledge-to-delete")),1)]),o("div",{class:C(["editor-button",i.drawingActive?"selected":""]),onClick:t[0]||(t[0]=u=>e.$emit("enable-ledge-creation"))},[o("h3",null,[d(l,{name:"fa6-solid:circle-plus"}),g(" "+n(e.$t("map.add-ledge")),1)]),o("p",null,n(e.$t("map.toggle-ledge-builder")),1)],2),o("div",{class:"editor-button",onClick:t[1]||(t[1]=u=>e.$emit("launch-editor","MENU"))},[o("h3",null,[d(l,{name:"fa6-solid:circle-xmark"}),g(" "+n(e.$t("map.close-ledge-menu")),1)])])])}const Do=k(Eo,[["render",Io],["__scopeId","data-v-3e0e930b"]]);const No={name:"EditFoliage",props:{drawingActive:Boolean}},Lo={class:"foliage-menu"},So={"data-foliage":"delete-help"};function To(e,t,i,m,a,s){const l=N;return r(),c("div",Lo,[o("p",So,[d(l,{name:"fa6-solid:trash"}),g(" "+n(e.$t("map.click-foliage-to-delete")),1)]),o("div",{class:C(["editor-button",i.drawingActive?"selected":""]),onClick:t[0]||(t[0]=u=>e.$emit("enable-foliage-creation"))},[o("h3",null,[d(l,{name:"fa6-solid:circle-plus"}),g(" "+n(e.$t("map.add-foliage")),1)]),o("p",null,n(e.$t("map.toggle-foliage-builder")),1)],2),o("div",{class:"editor-button",onClick:t[1]||(t[1]=u=>e.$emit("launch-editor","MENU"))},[o("h3",null,[d(l,{name:"fa6-solid:circle-xmark"}),g(" "+n(e.$t("map.close-foliage-menu")),1)])])])}const Ao=k(No,[["render",To],["__scopeId","data-v-1b68b35a"]]),Fo={name:"CopyDisguiseRegions",components:{GameIcon:D,GameButton:F,Modal:A},props:{disguises:Array},setup(){return{apiDomain:P().public.apiDomain}},data(){return{sourceDisguise:null,targetDisguise:null}},methods:{copyDisguiseAreas(){const e={originalDisguise:this.sourceDisguise,targetDisguise:this.targetDisguise};T(`${this.apiDomain}/api/disguise-areas/copy`,{method:"POST",body:e}).then(t=>{this.$emit("replace-disguise-areas",t.data.value),this.$toastr.s("Disguise areas copied!")}).catch(t=>{console.error(t),this.$toastr.e("Failed to copy disguise areas!")})},showModal(){this.$refs.innerModal.showModal()},hideModal(){this.$refs.innerModal.hideModal()}}},Oo={class:"alert alert-warning"},Vo={class:"row"},Ro={class:"col-md-6"},Po={class:"form-group"},Uo={for:"original-disguise"},Bo=o("br",null,null,-1),Go=["value"],Ho={class:"col-md-6"},qo={class:"form-group"},zo={for:"target-disguise"},Zo=o("br",null,null,-1),jo=["value"];function Jo(e,t,i,m,a,s){const l=D,u=F,h=A;return r(),y(h,{"modal-title":e.$t("map.copy-disguise-areas"),id:"copy-disguises-modal",ref:"innerModal",tabindex:"-1",role:"dialog"},{"modal-footer":v(()=>[d(u,{type:"button","data-dismiss":"modal",onClick:s.hideModal},{default:v(()=>[d(l,{icon:"failed","font-style":"normal"}),g(" "+n(e.$t("form.cancel")),1)]),_:1},8,["onClick"]),d(u,{type:"submit",id:"copy-disguise-regions-btn",onClick:s.copyDisguiseAreas},{default:v(()=>[d(l,{icon:"check","font-style":"normal"}),g(" "+n(e.$t("form.copy")),1)]),_:1},8,["onClick"])]),default:v(()=>[o("div",Oo,n(e.$t("map.copy-disguises-warning")),1),o("div",Vo,[o("div",Ro,[o("div",Po,[o("label",Uo,n(e.$t("map.source-disguise")),1),Bo,w(o("select",{id:"original-disguise",name:"original-disguise",ref:"originalDisguiseDropdown",class:"form-select","data-style":"control-button","onUpdate:modelValue":t[0]||(t[0]=_=>a.sourceDisguise=_),required:""},[(r(!0),c(b,null,M(i.disguises,_=>(r(),c("option",{value:_.id},n(_.suit?e.$t("map.suit-disguise",{suitName:_.name}):_.name),9,Go))),256))],512),[[Z,a.sourceDisguise]])])]),o("div",Ho,[o("div",qo,[o("label",zo,n(e.$t("map.target-disguise")),1),Zo,w(o("select",{id:"target-disguise",name:"target-disguise",ref:"targetDisguiseDropdown",class:"form-select","data-style":"control-button","onUpdate:modelValue":t[1]||(t[1]=_=>a.targetDisguise=_),required:""},[(r(!0),c(b,null,M(i.disguises,_=>(r(),c("option",{value:_.id},n(_.suit?e.$t("map.suit-disguise",{suitName:_.name}):_.name),9,jo))),256))],512),[[Z,a.targetDisguise]])])])])]),_:1},8,["modal-title"])}const Qo=k(Fo,[["render",Jo]]);const Wo={name:"EditDisguiseRegions",props:{disguises:Array,drawingActive:Boolean,currentDisguise:Object},data(){return{drawingType:null}},mounted(){this.currentDisguise&&(this.$refs.disguisePicker.value=this.currentDisguise.id)},methods:{changeDisguise(e){if(e.target.value==="NONE"){this.$emit("disguise-selected","NONE");return}this.$emit("disguise-selected",this.disguises.find(t=>t.id===parseInt(e.target.value,10)))},initDraw(e){this.drawingType=e,this.$emit("enable-region-creation",e)},initCopyDisguiseModal(){this.$refs.copyDisguiseModal.showModal()},onReplaceDisguiseAreas(e){this.$emit("replace-disguise-areas",e)}},watch:{currentDisguise(){this.$nextTick(e=>this.$refs.disguisePicker.value=this.currentDisguise===null?"NONE":this.currentDisguise.id)}}},Ko=e=>(B("data-v-56f1cbda"),e=e(),G(),e),Yo={class:"disguise-trespassing-menu"},xo={class:"delete-help"},Xo={class:"search-box"},ei=Ko(()=>o("option",{value:"NONE"},"None",-1)),ti=["value"];function oi(e,t,i,m,a,s){const l=N,u=Qo;return r(),c("div",Yo,[o("p",xo,[d(l,{name:"fa6-solid:trash"}),g(" "+n(e.$t("map.delete-existing-region")),1)]),o("p",null,n(e.$t("map.select-disguise-for-editing")),1),o("div",Xo,[o("select",{ref:"disguisePicker",name:"disguise-menu-dropdown",class:"form-select control-button",onChange:t[0]||(t[0]=(...h)=>s.changeDisguise&&s.changeDisguise(...h)),"data-style":"control-button"},[ei,(r(!0),c(b,null,M(i.disguises,h=>(r(),c("option",{key:h.id,value:h.id},n(h.suit?e.$t("map.suit-disguise",{suitName:h.name}):h.name),9,ti))),128))],544)]),i.currentDisguise!==null?(r(),c(b,{key:0},[o("div",{class:C(["editor-button",i.drawingActive&&a.drawingType==="trespassing"?"selected":""]),onClick:t[1]||(t[1]=h=>s.initDraw("trespassing"))},[o("h3",null,[d(l,{name:"fa6-solid:circle-plus"}),g(" "+n(e.$t("map.add-trespassing-region")),1)]),o("p",null,n(e.$t("map.toggle-trespassing-builder")),1)],2),o("div",{class:C(["editor-button",i.drawingActive&&a.drawingType==="hostile"?"selected":""]),onClick:t[2]||(t[2]=h=>s.initDraw("hostile"))},[o("h3",null,[d(l,{name:"fa6-solid:circle-plus"}),g(" "+n(e.$t("map.add-hostile-region")),1)]),o("p",null,n(e.$t("map.toggle-hostile-builder")),1)],2)],64)):(r(),c("div",{key:1,class:"editor-button",onClick:t[3]||(t[3]=(...h)=>s.initCopyDisguiseModal&&s.initCopyDisguiseModal(...h))},[o("h3",null,[d(l,{name:"fa6-solid:copy"}),g(" "+n(e.$t("map.copy-regions")),1)]),o("p",null,n(e.$t("map.click-to-copy-regions")),1)])),o("div",{class:"editor-button",onClick:t[4]||(t[4]=h=>e.$emit("launch-editor","MENU"))},[o("h3",null,[d(l,{name:"fa6-solid:circle-xmark"}),g(" "+n(e.$t("map.close-disguise-menu")),1)])]),d(u,{ref:"copyDisguiseModal",disguises:i.disguises,onReplaceDisguiseAreas:s.onReplaceDisguiseAreas},null,8,["disguises","onReplaceDisguiseAreas"])])}const ii=k(Wo,[["render",oi],["__scopeId","data-v-56f1cbda"]]);const si={name:"Sidebar",props:{game:Object,mission:Object,loggedIn:Boolean,categories:Array,nodes:Array,ledges:Array,foliage:Array,topLevelCategories:Array,disguises:Array,maxZoomLevel:Number,minZoomLevel:Number,currentZoomLevel:Number,editorState:String,drawingActive:Boolean,currentDisguise:Object,currentVariant:Object},setup(){const{cookies:e}=De(),{locale:t}=pe();return{cookies:e,locale:t}},data(){return{debugMode:!1}},watch:{zoomControl:function(){console.log(this.zoomControl)}},computed:{countryFlag(){return _e.getCountryFlagForLocale(this.locale)}},methods:{showLocaleModal(){this.$refs.localeModal.showModal()},getAllVariantsForUser(){return this.loggedIn?this.mission.variants:this.mission.variants.filter(e=>e.visible)},showDebug(){return{}.VITE_SHOW_DEBUG==="true"},getSearchableNodes(){const e=[...this.nodes].filter(m=>m.variants.includes(this.currentVariant.id));e.sort((m,a)=>{if(m.type!==a.type)return this.topLevelCategories.indexOf(m.type)<this.topLevelCategories.indexOf(a.type)?-1:1;const s=this.categories.find(u=>u.type===m.type&&u.group===m.group),l=this.categories.find(u=>u.type===a.type&&u.group===a.group);return s.order!==l.order?s.order<l.order?-1:1:m.name<a.name?-1:1});const t=e.filter(m=>m.searchable).map(m=>`${m.group}|${m.name}`).filter((m,a,s)=>s.indexOf(m)===a),i={};return t.forEach(m=>{const a=m.split("|");a[0]in i||(i[a[0]]=[]),i[a[0]].push(a[1])}),i},beginDiscordLogin(){this.cookies.set("redirect-location",`${window.location.pathname}${window.location.search}`,"600s"),window.location.href=`https://discordapp.com/api/oauth2/authorize?client_id=681919936469401687&redirect_uri=${encodeURIComponent(`${window.location.protocol}//${window.location.host}`)}/auth&response_type=token&scope=connections%20identify%20guilds%20email`},logout:function(){localStorage.removeItem("token"),location.reload()},onSearchItem(e){this.$emit("search-item",e)},onHideCategory(e){this.$emit("hide-category",e)},onShowCategory(e){this.$emit("show-category",e)},onHideTopLevelCategory(e){this.$emit("hide-top-level-category",e)},onShowTopLevelCategory(e){this.$emit("show-top-level-category",e)},onLaunchEditor(e){this.$emit("launch-editor",e)},onEnableLedgeCreation(){this.$emit("enable-ledge-creation")},onEnableFoliageCreation(){this.$emit("enable-foliage-creation")},onDisguiseSelected(e){this.$emit("disguise-selected",e)},onEnableRegionCreation(e){this.$emit("enable-region-creation",e)},onReplaceDisguiseAreas(e){this.$emit("replace-disguise-areas",e)},onChangeFloor(e){this.$emit("change-floor",e)},onVariantSelected(e){this.$emit("variant-selected",e)}}},ie=e=>(B("data-v-35ef75a8"),e=e(),G(),e),ai={class:"navbar navbar-fixed-right navbar-dark"},ni={class:"mobile-header"},ri={class:"logo"},li=ie(()=>o("img",{src:Ne,class:"img-fluid d-block d-md-none",alt:"HITMAPS Logo"},null,-1)),di={class:"header-buttons"},ci={key:0,class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#variants-toggle","aria-controls":"variants-toggle","aria-expanded":"true","aria-label":"Toggle variant selection box"},ui={class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#search-item-toggle","aria-controls":"search-item-toggle","aria-expanded":"true","aria-label":"Toggle search box"},mi={class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#disguises-toggle","aria-controls":"disguises-toggle","aria-expanded":"false","aria-label":"Toggle disguises box"},hi={class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#floors-and-layers-toggle","aria-controls":"floors-and-layers-toggle","aria-expanded":"false","aria-label":"Toggle floors and layers box"},gi={class:"navbar-collapse"},pi={class:"header d-none d-md-block"},_i=ie(()=>o("img",{src:Le,class:"img-fluid",alt:"HITMAPS Logo"},null,-1)),fi={class:"map-control d-none d-md-flex"},vi={id:"map-control-buttons"},yi={class:"control-buttons"},bi={class:"collapse navbar-collapse",id:"variants-toggle"},$i={class:"navbar-collapse collapse show",id:"search-item-toggle"},ki={class:"collapse navbar-collapse",id:"disguises-toggle"},wi={class:"collapse navbar-collapse",id:"floors-and-layers-toggle"};function Ei(e,t,i,m,a,s){const l=fe,u=D,h=N,_=j("country-flag"),E=at,p=oe,S=Ie,O=wt,Q=Ot,ae=Kt,ne=eo,re=po,le=yo,de=wo,ce=Do,ue=Ao,me=ii,he=ve,H=ee("tooltip");return r(),c("nav",ai,[o("div",ni,[o("div",ri,[d(l,{to:"/"},{default:v(()=>[li]),_:1})]),o("div",di,[s.getAllVariantsForUser().length>1?(r(),c("button",ci,[d(u,{icon:i.currentVariant.icon,"font-style":"solid"},null,8,["icon"])])):f("",!0),o("button",ui,[d(h,{name:"fa:search"})]),o("button",mi,[d(h,{name:"fa6-regular:user"})]),o("button",hi,[d(h,{name:"fa6-solid:layer-group"})]),o("button",{class:"navbar-toggler",onClick:t[0]||(t[0]=(...I)=>s.showLocaleModal&&s.showLocaleModal(...I)),type:"button"},[w(d(_,{country:s.countryFlag,size:"small"},null,8,["country"]),[[H,e.$t("language-modal.change-language"),"top"]])])])]),o("div",gi,[o("div",pi,[d(l,{to:"/"},{default:v(()=>[_i]),_:1})]),i.editorState!=="OFF"&&i.editorState!=="MENU"?(r(),y(E,{key:0,"editor-state":i.editorState},null,8,["editor-state"])):f("",!0),o("div",fi,[o("div",vi,[d(p,{onClick:t[1]||(t[1]=I=>e.$emit("zoom-in")),class:C(i.currentZoomLevel===i.maxZoomLevel?"disabled":"")},{default:v(()=>[g("+")]),_:1},8,["class"]),d(p,{onClick:t[2]||(t[2]=I=>e.$emit("zoom-out")),class:C(i.currentZoomLevel===i.minZoomLevel?"disabled":"")},{default:v(()=>[g("-")]),_:1},8,["class"])]),o("div",yi,[d(p,{onClick:s.showLocaleModal},{default:v(()=>[w(d(_,{country:s.countryFlag,size:"small"},null,8,["country"]),[[H,e.$t("language-modal.change-language"),"top"]])]),_:1},8,["onClick"]),i.loggedIn?(r(),c(b,{key:0},[s.showDebug()?w((r(),y(p,{key:0,id:"debug-button",onClick:t[3]||(t[3]=I=>a.debugMode=!a.debugMode),style:z(a.debugMode?"background: white; color: black":"")},{default:v(()=>[d(h,{name:"fa6-solid:bug"})]),_:1},8,["style"])),[[H,e.$t("map.debug-mode"),"top"]]):f("",!0),w((r(),y(p,{id:"edit-button",onClick:t[4]||(t[4]=I=>e.$emit("master-edit-toggle"))},{default:v(()=>[d(h,{name:"fa6-solid:pencil"})]),_:1})),[[H,e.$t("map.edit-map"),"top"]]),w((r(),y(p,{onClick:s.logout},{default:v(()=>[d(h,{name:"fa:sign-out"})]),_:1},8,["onClick"])),[[H,e.$t("authentication.log-out"),"top"]])],64)):(r(),c("a",{key:1,onClick:t[5]||(t[5]=(...I)=>s.beginDiscordLogin&&s.beginDiscordLogin(...I))},[d(p,null,{default:v(()=>[d(h,{name:"fa:sign-in"})]),_:1})]))])]),w(o("div",null,[i.currentVariant.icon==="freelancer"?(r(),y(S,{key:0,type:"info"},{default:v(()=>[g(n(e.$t("map.freelancer-note")),1)]),_:1})):f("",!0),o("div",bi,[d(O,{mission:i.mission,"current-variant":i.currentVariant,"logged-in":i.loggedIn,onVariantSelected:s.onVariantSelected},null,8,["mission","current-variant","logged-in","onVariantSelected"])]),o("div",$i,[d(Q,{"searchable-nodes":s.getSearchableNodes(),onSearchItem:s.onSearchItem},null,8,["searchable-nodes","onSearchItem"])]),o("div",ki,[d(ae,{game:i.game,mission:i.mission,disguises:i.disguises,"current-disguise":i.currentDisguise,onDisguiseSelected:s.onDisguiseSelected},null,8,["game","mission","disguises","current-disguise","onDisguiseSelected"])]),o("div",wi,[d(ne,{onHideAll:t[6]||(t[6]=I=>e.$emit("hide-all")),onShowAll:t[7]||(t[7]=I=>e.$emit("show-all"))}),(r(!0),c(b,null,M(i.topLevelCategories,I=>(r(),y(re,{key:I,"top-level-category-name":I,categories:i.categories.filter(W=>W.type===I),nodes:i.nodes.filter(W=>W.type===I),ledges:i.ledges,foliage:i.foliage,onHideCategory:s.onHideCategory,onShowCategory:s.onShowCategory,onHideTopLevelCategory:s.onHideTopLevelCategory,onShowTopLevelCategory:s.onShowTopLevelCategory},null,8,["top-level-category-name","categories","nodes","ledges","foliage","onHideCategory","onShowCategory","onHideTopLevelCategory","onShowTopLevelCategory"]))),128))])],512),[[x,i.editorState==="OFF"]]),i.editorState==="MENU"?(r(),y(le,{key:1,"nodes-only":i.mission.missionType==="Sniper Assassin",onLaunchEditor:s.onLaunchEditor},null,8,["nodes-only","onLaunchEditor"])):f("",!0),i.editorState==="ITEMS"?(r(),y(de,{key:2,onLaunchEditor:s.onLaunchEditor},null,8,["onLaunchEditor"])):f("",!0),i.editorState==="LEDGES"?(r(),y(ce,{key:3,"drawing-active":i.drawingActive,onEnableLedgeCreation:s.onEnableLedgeCreation,onLaunchEditor:s.onLaunchEditor},null,8,["drawing-active","onEnableLedgeCreation","onLaunchEditor"])):f("",!0),i.editorState==="FOLIAGE"?(r(),y(ue,{key:4,"drawing-active":i.drawingActive,onEnableFoliageCreation:s.onEnableFoliageCreation,onLaunchEditor:s.onLaunchEditor},null,8,["drawing-active","onEnableFoliageCreation","onLaunchEditor"])):f("",!0),i.editorState==="DISGUISE-REGIONS"?(r(),y(me,{key:5,"drawing-active":i.drawingActive,"current-disguise":i.currentDisguise,disguises:i.disguises,onDisguiseSelected:s.onDisguiseSelected,onEnableRegionCreation:s.onEnableRegionCreation,onLaunchEditor:s.onLaunchEditor,onReplaceDisguiseAreas:s.onReplaceDisguiseAreas},null,8,["drawing-active","current-disguise","disguises","onDisguiseSelected","onEnableRegionCreation","onLaunchEditor","onReplaceDisguiseAreas"])):f("",!0)]),d(he,{ref:"localeModal","flag-size":"hidden"},null,512)])}const Mi=k(si,[["render",Ei],["__scopeId","data-v-35ef75a8"]]);const Ci={name:"NodePopup",components:{GameButton:F,GameIcon:D,Modal:A},props:{game:Object,node:Object,loggedIn:Boolean,editorState:String},setup(){return{apiDomain:P().public.apiDomain}},data(){return{showingConfirmDeletion:!1,blockDeleteButton:!1}},computed:{agencyPickupName(){return this.node.icon==="agency-pickup"?"Agency Pickup":"Hidden Stash"},descriptionNote(){return this.node.notes.find(e=>e.type==="description")},backgroundCss(){if(!this.node.image)return"";let e;return this.game.slug==="absolution"?e=`background-image: url('${this.node.image}'), radial-gradient(#69696a, #171718)`:e=`background: url('${this.node.image}') center center / cover no-repeat`,e},actionTextForActionTarget(){return this.node.icon==="poison"?this.$t("map.npc"):["interaction","sabotage","distraction","alarm"].includes(this.node.subgroup)?this.$t("map.action"):null},fontIconForActionTarget(){return this.node.icon==="poison"?"npc":["interaction","sabotage","distraction","alarm"].includes(this.node.subgroup)?"settings":null},fontIconForNodeSubgroup(){switch(this.node.subgroup){case"sabotage":case"explosive":return"explosive";case"distraction":return"distraction";case"poison":case"poison-weapon":return"poison";case"misc-item":return this.getMiscItemIcon(this.node);case"intel":case"camera-intel":return"intel";case"disguise":return"disguise";case"blend-in":return"emote";case"conceal-item":case"weapon-crate":return"loadout";case"locked-door":return"locked";case"interaction":return"tool";case"alarm":return"online";case"frisk":return"frisk";case"location":return"story";case"lethal-melee":case"non-lethal-melee":return"melee";case"firearm":return"concealed-weapon";case"ammo":return"difficulty-3";case"starting-location":return"starting";case"exit-location":return"exit";case"agency-pickup":return"stash-point-empty";case"area":return"info";case"passage":return"arrow-right";case"up-pipe":case"up-stair":return"elevation";default:return"corrupt"}}},methods:{resetDeletionState(){this.showingConfirmDeletion=!1},getLocalizedNoteType(e){return e.type==="info"?this.$t("map.information"):this.$t(`map.${e.type}`)},getMiscItemIcon(e){return e.icon.includes("key")?"key":"challenge-category-item"},showConfirmDeletion(){this.showingConfirmDeletion=!0},deleteNode(){this.blockDeleteButton=!0,T(`${this.apiDomain}/api/nodes/${this.node.id}`,{method:"DELETE"}).then(e=>{this.blockDeleteButton=!1,this.showingConfirmDeletion=!1,this.$toastr.s("Item deleted!"),this.$emit("delete-node",this.node.id),this.hideModal()}).catch(e=>{this.blockDeleteButton=!1,this.showingConfirmDeletion=!1,this.$toastr.e("Failed to delete item!")})},showModal(){this.$refs["popover-modal"].showModal()},hideModal(){this.$refs["popover-modal"].hideModal()}}},Ii={key:0,class:"popover-content"},Di={key:0,class:"image"},Ni=["src"],Li={class:"icon-and-details"},Si={key:0,class:"icon"},Ti={class:"inner-details"},Ai={key:0,class:"group"},Fi={class:"name"},Oi={key:0,class:"description"},Vi={key:1,class:"notes"},Ri={class:"type"},Pi={key:2,class:"target"},Ui={class:"header-and-target"},Bi={class:"action-or-npc-name"},Gi={key:0,class:"edit-delete-buttons"},Hi={class:"edit"},qi={class:"delete"};function zi(e,t,i,m,a,s){const l=D,u=F,h=A;return r(),y(h,{id:"popover-modal",ref:"popover-modal",tabindex:"-1",flush:""},{"modal-footer":v(()=>[i.loggedIn&&i.editorState==="ITEMS"?(r(),c("div",Gi,[o("div",Hi,[d(u,{"data-dismiss":"modal",onClick:t[0]||(t[0]=_=>e.$emit("edit-node",i.node.id))},{default:v(()=>[d(l,{icon:"edit","font-style":"normal"}),g(" "+n(e.$t("map.edit")),1)]),_:1})]),o("div",qi,[a.showingConfirmDeletion?f("",!0):(r(),y(u,{key:0,onClick:s.showConfirmDeletion},{default:v(()=>[d(l,{icon:"trash","font-style":"normal"}),g(" "+n(e.$t("map.delete")),1)]),_:1},8,["onClick"])),a.showingConfirmDeletion?(r(),y(u,{key:1,onClick:s.deleteNode,disabled:a.blockDeleteButton},{default:v(()=>[d(l,{icon:"arrow-right","font-style":"normal"}),g(" "+n(e.$t("map.confirm-item-deletion-title",{item:"Node"})),1)]),_:1},8,["onClick","disabled"])):f("",!0)])])):f("",!0),d(u,{"data-dismiss":"modal",onClick:s.hideModal},{default:v(()=>[d(l,{icon:"failed","font-style":"normal"}),g(" "+n(e.$t("form.close")),1)]),_:1},8,["onClick"])]),default:v(()=>[i.node?(r(),c("div",Ii,[i.node.image?(r(),c("div",Di,[o("img",{src:i.node.image,class:"img-fluid"},null,8,Ni)])):f("",!0),o("div",{class:C(["details",i.node.image?"":"no-image"])},[o("div",Li,[s.fontIconForNodeSubgroup!=="corrupt"?(r(),c("div",Si,[d(l,{icon:s.fontIconForNodeSubgroup,"font-style":"solid"},null,8,["icon"])])):f("",!0),o("div",Ti,[i.node.name!==""?(r(),c("p",Ai,n(i.node.subgroup==="agency-pickup"?s.agencyPickupName:i.node.group),1)):f("",!0),o("p",Fi,n(i.node.name===""?i.node.group:i.node.name),1)])]),s.descriptionNote?(r(),c("div",Oi,n(s.descriptionNote.text),1)):f("",!0),i.node.notes.filter(_=>_.type!=="description").length?(r(),c("div",Vi,[(r(!0),c(b,null,M(i.node.notes.filter(_=>_.type!=="description"),_=>(r(),c("div",{class:C(["note",_.type])},[o("div",Ri,n(s.getLocalizedNoteType(_)),1),o("div",null,n(_.text),1)],2))),256))])):f("",!0),i.node.target!==null&&i.node.target!==""&&i.node.subgroup!=="agency-pickup"?(r(),c("div",Pi,[s.fontIconForActionTarget?(r(),y(l,{key:0,icon:s.fontIconForActionTarget,"font-style":"normal"},null,8,["icon"])):f("",!0),o("div",Ui,[o("div",null,n(s.actionTextForActionTarget),1),o("div",Bi,n(i.node.target),1)])])):f("",!0)],2)])):f("",!0)]),_:1},512)}const Zi=k(Ci,[["render",zi],["__scopeId","data-v-a549e175"]]);const ji={class:"d-grid"},Ji={class:"btn btn-light btn-block dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Qi=["innerHTML"],Wi={class:"dropdown-arrow"},Ki={class:"dropdown-menu"},Yi={class:"search-input"},xi={class:"dropdown-options"},Xi={class:"dropdown-header"},es=["onClick"],ts=["innerHTML"],os={__name:"FancyDropdown",props:{placeholder:{type:String,default:"Select One"},elements:{type:Array,required:!0},modelValue:Object},emits:["update:modelValue","change"],setup(e,{emit:t}){const i=e;let m=ye("");function a(){m.value=""}function s(u){t("update:modelValue",u),t("change",u)}function l(){if(!m.value)return i.elements;const u=[];for(const h of i.elements){const _=h.groupItems.filter(E=>E.value.toLowerCase().includes(m.value.toLowerCase()));_.length&&u.push({groupName:h.groupName,groupItems:_})}return u}return(u,h)=>{const _=N;return r(),c("div",Y({class:"dropdown bootstrap-select",role:"menu"},te({"hide.bs.dropdown":a},!0)),[o("div",ji,[o("button",Ji,[e.modelValue?(r(),c(b,{key:0},[e.modelValue.html?(r(),c("span",{key:0,innerHTML:e.modelValue.display},null,8,Qi)):(r(),c(b,{key:1},[g(n(e.modelValue.display),1)],64))],64)):(r(),c(b,{key:1},[g(n(e.placeholder),1)],64)),o("span",Wi,[d(_,{name:"fa6-solid:caret-down"})])]),o("div",Ki,[o("div",Yi,[w(o("input",{class:"form-control","onUpdate:modelValue":h[0]||(h[0]=E=>$e(m)?m.value=E:m=E)},null,512),[[R,be(m)]])]),o("div",xi,[(r(!0),c(b,null,M(l(),E=>(r(),c(b,null,[o("h6",Xi,n(E.groupName),1),(r(!0),c(b,null,M(E.groupItems,p=>(r(),c("a",{class:"dropdown-item",href:"#",onClick:S=>s(p)},[p.html?(r(),c("span",{key:1,innerHTML:p.display},null,8,ts)):(r(),c(b,{key:0},[g(n(p.display),1)],64))],8,es))),256))],64))),256))])])])],16)}}},is=k(os,[["__scopeId","data-v-35c18e5e"]]);class V{static moveElement(t,i,m){let a=t[i];return t.splice(i,1),t.splice(m,0,a),t}static deleteElementByIndex(t,i){return t.splice(i,1),t}static deleteElement(t,i){const m=t.indexOf(i);return m>-1&&t.splice(m,1),t}}var ss=q;function q(e){let t=e;var i={}.toString.call(e).slice(8,-1);if(i=="Set")return new Set([...e].map(a=>q(a)));if(i=="Map")return new Map([...e].map(a=>[q(a[0]),q(a[1])]));if(i=="Date")return new Date(e.getTime());if(i=="RegExp")return RegExp(e.source,as(e));if(i=="Array"||i=="Object"){t=Array.isArray(e)?[]:{};for(var m in e)t[m]=q(e[m])}return t}function as(e){if(typeof e.source.flags=="string")return e.source.flags;var t=[];return e.global&&t.push("g"),e.ignoreCase&&t.push("i"),e.multiline&&t.push("m"),e.sticky&&t.push("y"),e.unicode&&t.push("u"),t.join("")}const ns={name:"AddEditItemModal",props:{mission:Object,categories:Array,topLevelCategories:Array,currentLevel:Number,clickedPoint:Object,node:Object},setup(){const e=X(),i=P().public.apiDomain;return{uuid:e,apiDomain:i}},data(){return{defaultCreateEditNodeModel:{category:null,icon:"",name:"",quantity:1,targetAction:"",image:"",notes:[],variantIds:[]},createEditNodeModel:{category:null,icon:"",name:"",quantity:1,targetAction:"",image:"",notes:[],variantIds:[]},groupedCategories:[],icons:[],selectedIcon:null,templates:[],selectedTemplate:null,currentCategory:null,previousCategory:null,uid:this.uuid}},mounted(){$fetch(`${this.apiDomain}/api/v1/editor/icons`).then(e=>{const t=[];for(const[i,m]of Object.entries(e)){const a={groupName:i,groupItems:[]};for(const s of m){const l={element:s,value:s.icon,display:`<img height="24" width="24" src="/img/map-icons/${s.icon}.png" alt="${s.altText} Icon"> ${s.altText}`,html:!0};a.groupItems.push(l)}t.push(a)}this.icons=t}),$fetch(`${this.apiDomain}/api/v1/editor/templates`).then(e=>{const t=[];for(const[i,m]of Object.entries(e)){const a={groupName:i,groupItems:[]};for(const s of m){const l={element:s,value:s.name,display:s.name,html:!1};a.groupItems.push(l)}t.push(a)}this.templates=t})},computed:{pickIconAllowed(){return this.currentCategory?!["exit-location","ledge","foliage","starting-location"].includes(this.currentCategory.element.subgroup):!0}},methods:{buildTemplateElements(){const e=[];for(const[t,i]of Object.entries(this.templates)){const m={groupName:t,groupItems:[]};for(const a of i){const s={element:a,value:a.name,display:a.name,html:!1};m.groupItems.push(s)}e.push(m)}return e},buildCategoryElements(){const e=[];for(const t of this.topLevelCategories){const i={groupName:t,groupItems:[]};for(const m of this.categories.filter(a=>a.type===t)){const a={element:m,value:m.group,display:`<img height="24" width="24" src="/img/map-icons/${m.icon}.png" alt="${m.group} Icon"> ${m.group}`,html:!0};i.groupItems.push(a)}e.push(i)}this.groupedCategories=e},initializeAddEditModal(){this.selectedIcon=null,this.selectedTemplate=null,this.currentCategory=null,this.createEditNodeModel=ss(this.defaultCreateEditNodeModel),this.node!==null&&(this.createEditNodeModel.category=this.groupedCategories.find(e=>e.groupName===this.node.type).groupItems.find(e=>e.element.subgroup===this.node.subgroup),this.currentCategory=this.createEditNodeModel.category,this.selectCategory(),this.createEditNodeModel.icon=this.node.icon,this.selectedIcon=this.icons.flatMap(e=>e.groupItems).find(e=>e.value===this.createEditNodeModel.icon),this.createEditNodeModel.name=this.node.name,this.createEditNodeModel.quantity=this.node.quantity,this.createEditNodeModel.targetAction=this.node.target,this.createEditNodeModel.image=this.node.image,this.createEditNodeModel.notes=this.node.notes.map(e=>({type:e.type,text:e.text})),this.createEditNodeModel.variantIds=this.node.variants)},selectCategory(){this.currentCategory&&(this.createEditNodeModel.category=this.currentCategory,this.createEditNodeModel.icon=this.currentCategory.element.icon,this.previousCategory!==null&&(this.previousCategory.element.requireAction!==this.currentCategory.element.requireAction||this.previousCategory.element.requireTarget!==this.currentCategory.element.requireTarget)&&(this.createEditNodeModel.targetAction=""),this.selectedIcon=this.icons.flatMap(e=>e.groupItems).find(e=>e.value===this.createEditNodeModel.icon),this.previousCategory=this.currentCategory)},modifyNote(e,t){switch(e){case"DELETE":V.deleteElementByIndex(this.createEditNodeModel.notes,t);break;case"DOWN":V.moveElement(this.createEditNodeModel.notes,t,t+1);break;case"UP":V.moveElement(this.createEditNodeModel.notes,t,t-1);break}},applyTemplate(){if(!this.selectedTemplate)return;const e=this.selectedTemplate.element;this.createEditNodeModel.name=e.name,this.createEditNodeModel.targetAction=e.target,this.createEditNodeModel.quantity=1,this.createEditNodeModel.image=e.image,this.createEditNodeModel.icon=e.icon,this.selectedIcon=this.icons.flatMap(t=>t.groupItems).find(t=>t.value===this.createEditNodeModel.icon),this.createEditNodeModel.category=this.groupedCategories.find(t=>t.groupName===e.type).groupItems.find(t=>t.element.subgroup===e.subgroup),this.currentCategory=this.createEditNodeModel.category,this.createEditNodeModel.notes=[],e.description&&this.createEditNodeModel.notes.push({type:"description",text:e.description}),e.requirement&&this.createEditNodeModel.notes.push({type:"requirement",text:e.requirement}),e.warning&&this.createEditNodeModel.notes.push({type:"warning",text:e.warning}),e.information&&this.createEditNodeModel.notes.push({type:"info",text:e.information})},saveMarker(){if(!this.createEditNodeModel.variantIds.length){alert("You must select at least one mission variant");return}this.node?this.updateMarker():this.createMarker()},createMarker(){console.log({missionId:this.mission.id,icon:this.createEditNodeModel.icon,category:this.createEditNodeModel.category.element,name:this.createEditNodeModel.name,quantity:this.createEditNodeModel.quantity,targetAction:this.createEditNodeModel.targetAction,level:this.currentLevel,latitude:this.clickedPoint.lat,longitude:this.clickedPoint.lng,image:this.createEditNodeModel.image,notes:this.createEditNodeModel.notes,variantIds:this.createEditNodeModel.variantIds}),T(`${this.apiDomain}/api/nodes`,{method:"POST",body:{missionId:this.mission.id,icon:this.createEditNodeModel.icon,category:this.createEditNodeModel.category.element,name:this.createEditNodeModel.name,quantity:this.createEditNodeModel.quantity,targetAction:this.createEditNodeModel.targetAction,level:this.currentLevel,latitude:this.clickedPoint.lat,longitude:this.clickedPoint.lng,image:this.createEditNodeModel.image,notes:this.createEditNodeModel.notes,variantIds:this.createEditNodeModel.variantIds}}).then(e=>{const t=JSON.parse(e.data.value);this.$emit("item-created",t.data),this.$toastr.s("Item saved!")}).catch(e=>{this.$toastr.e("Changes failed to save!")})},updateMarker(){T(`${this.apiDomain}/api/nodes/${this.node.id}`,{method:"PUT",body:{missionId:this.mission.id,icon:this.createEditNodeModel.icon,category:this.createEditNodeModel.category.element,name:this.createEditNodeModel.name,quantity:this.createEditNodeModel.quantity,targetAction:this.createEditNodeModel.targetAction,level:this.currentLevel,latitude:this.node.latitude,longitude:this.node.longitude,image:this.createEditNodeModel.image,notes:this.createEditNodeModel.notes,variantIds:this.createEditNodeModel.variantIds}}).then(e=>{const t=e.data.value;this.$emit("item-updated",t.data),this.$toastr.s("Item updated!")}).catch(e=>{console.log(e),this.$toastr.e("Changes failed to save!")})},showModal(){this.$refs.innerModal.showModal()},hideModal(){this.$refs.innerModal.hideModal()}},watch:{topLevelCategories(){this.buildCategoryElements()},selectedIcon(){this.selectedIcon&&(this.createEditNodeModel.icon=this.selectedIcon.value)}}},se=e=>(B("data-v-2594fb4d"),e=e(),G(),e),rs={class:"row"},ls={class:"col-md-12"},ds={class:"alert alert-dark",style:{"font-size":".8em"}},cs={class:"form-group row"},us=["for"],ms={class:"col-sm-10"},hs=se(()=>o("hr",null,null,-1)),gs={class:"row"},ps={class:"col-lg-6 col-md-12"},_s=se(()=>o("h3",null,"Item Info",-1)),fs={class:"form-group row"},vs=["for"],ys={class:"col-sm-10"},bs={key:0,class:"form-text text-muted",id:"note-help-text"},$s={key:0,class:"form-group row",id:"icon-form-group"},ks=["for"],ws={class:"col-sm-10 icon-dropdown"},Es={key:1},Ms={key:0,class:"form-group row"},Cs=["for"],Is={class:"col-sm-10"},Ds=["id"],Ns={class:"form-text text-muted"},Ls={class:"form-group row"},Ss=["for"],Ts={class:"col-sm-10"},As=["id"],Fs=["value"],Os={key:1,class:"form-group row"},Vs=["for"],Rs={class:"col-sm-10"},Ps=["id"],Us={class:"form-text text-muted"},Bs={key:2,class:"form-group row"},Gs=["for"],Hs={class:"col-sm-10"},qs=["id"],zs={class:"form-text text-muted"},Zs={class:"form-group row"},js=["for"],Js={class:"col-sm-10"},Qs=["id"],Ws={class:"form-text text-muted"},Ks={class:"col-lg-6 col-md-12"},Ys={id:"suggest-notes"},xs={class:"row"},Xs={class:"col-sm-3"},ea={key:0,class:"d-grid"},ta=["onClick"],oa={key:1,class:"d-grid"},ia=["onClick"],sa={class:"d-grid"},aa=["onClick"],na={class:"col-sm-9"},ra={class:"form-group row"},la={for:"note-type[]",class:"col-sm-2 col-form-label"},da={class:"col-sm-10"},ca=["onUpdate:modelValue"],ua={value:"requirement"},ma={value:"warning"},ha={value:"info"},ga={value:"description"},pa={class:"form-group row"},_a={for:"note-text[]",class:"col-sm-2 col-form-label"},fa={class:"col-sm-10"},va=["onUpdate:modelValue"],ya={class:"form-group row",style:{"margin-top":"10px"}},ba={class:"col"},$a={class:"form-group"},ka={class:"form-check"},wa=["id","value"],Ea=["for"];function Ma(e,t,i,m,a,s){const l=is,u=N,h=D,_=F,E=A;return r(),y(E,{"modal-title":e.$t("map.add-edit-item"),ref:"innerModal",id:"edit-item-modal",tabindex:"-1",role:"dialog",fullscreen:""},{"modal-footer":v(()=>[d(_,{type:"button","data-dismiss":"modal",onClick:s.hideModal},{default:v(()=>[d(h,{icon:"failed","font-style":"normal"}),g(" "+n(e.$t("form.close")),1)]),_:1},8,["onClick"]),d(_,{type:"submit",onClick:s.saveMarker,ref:"saveMarkerButton"},{default:v(()=>[d(h,{icon:"check","font-style":"normal"}),g(" "+n(e.$t("form.save")),1)]),_:1},8,["onClick"])]),default:v(()=>[o("div",rs,[o("div",ls,[o("div",ds,[g(n(e.$t("map.please-indicate-when-adding"))+" ",1),o("ul",null,[o("li",null,n(e.$t("map.required-items")),1),o("li",null,n(e.$t("map.suspicious-items")),1),o("li",null,n(e.$t("map.information-items")),1),o("li",null,n(e.$t("map.in-game-description-items")),1),o("li",null,n(e.$t("map.blank-notes")),1)])]),w(o("div",null,[o("h3",null,n(e.$t("map.apply-template")),1),o("div",cs,[o("label",{for:`${a.uid}-template`,class:"col sm-2 col-form-label"},n(e.$t("map.template")),9,us),o("div",ms,[d(l,{ref:"templatePicker",onChange:s.applyTemplate,modelValue:a.selectedTemplate,"onUpdate:modelValue":t[0]||(t[0]=p=>a.selectedTemplate=p),elements:a.templates},null,8,["onChange","modelValue","elements"])])]),hs],512),[[x,i.mission.missionType!=="Sniper Assassin"]])])]),o("div",gs,[o("div",ps,[_s,o("div",fs,[o("label",{for:`${a.uid}-subgroup`,class:"col-sm-2 col-form-label"},n(e.$t("map.category")),9,vs),o("div",ys,[d(l,{onChange:s.selectCategory,modelValue:a.currentCategory,"onUpdate:modelValue":t[1]||(t[1]=p=>a.currentCategory=p),elements:a.groupedCategories},null,8,["onChange","modelValue","elements"]),a.currentCategory?(r(),c("small",bs,n(a.currentCategory.note),1)):f("",!0)])]),s.pickIconAllowed?(r(),c("div",$s,[o("label",{for:`${a.uid}-icon`,class:"col-sm-2 col-form-label"},n(e.$t("map.icon")),9,ks),o("div",ws,[d(l,{modelValue:a.selectedIcon,"onUpdate:modelValue":t[2]||(t[2]=p=>a.selectedIcon=p),elements:a.icons},null,8,["modelValue","elements"])])])):f("",!0),a.currentCategory?(r(),c("div",Es,[a.currentCategory.element.requireName?(r(),c("div",Ms,[o("label",{for:`${a.uid}-name`,class:"col-sm-2 col-form-label"},n(e.$t("map.name")),9,Cs),o("div",Is,[w(o("textarea",{type:"text",name:"name","onUpdate:modelValue":t[3]||(t[3]=p=>a.createEditNodeModel.name=p),id:`${a.uid}-name`,class:"form-control"},null,8,Ds),[[R,a.createEditNodeModel.name]]),o("small",Ns,n(e.$t("map.name-note")),1)])])):f("",!0),o("div",Ls,[o("label",{for:`${a.uid}-quantity`,class:"col-sm-2 col-form-label"},n(e.$t("map.quantity")),9,Ss),o("div",Ts,[w(o("select",{name:"quantity",id:`${a.uid}-quantity`,"onUpdate:modelValue":t[4]||(t[4]=p=>a.createEditNodeModel.quantity=p),class:"form-select"},[(r(),c(b,null,M(10,p=>o("option",{value:p},n(p),9,Fs)),64))],8,As),[[Z,a.createEditNodeModel.quantity]])])]),a.currentCategory.element.requireAction?(r(),c("div",Os,[o("label",{for:`${a.uid}-action`,class:"col-sm-2 col-form-label"},n(e.$t("map.action")),9,Vs),o("div",Rs,[w(o("input",{type:"text",name:"action",id:`${a.uid}-action`,"onUpdate:modelValue":t[5]||(t[5]=p=>a.createEditNodeModel.targetAction=p),class:"form-control"},null,8,Ps),[[R,a.createEditNodeModel.targetAction]]),o("small",Us,n(e.$t("map.action-note")),1)])])):f("",!0),a.currentCategory.element.requireTarget?(r(),c("div",Bs,[o("label",{for:`${a.uid}-target`,class:"col-sm-2 col-form-label"},n(e.$t("map.target")),9,Gs),o("div",Hs,[w(o("input",{type:"text",name:"target",id:`${a.uid}-target`,"onUpdate:modelValue":t[6]||(t[6]=p=>a.createEditNodeModel.targetAction=p),class:"form-control"},null,8,qs),[[R,a.createEditNodeModel.targetAction]]),o("small",zs,n(e.$t("map.target-note")),1)])])):f("",!0),o("div",Zs,[o("label",{for:`${a.uid}-image`,class:"col-sm-2 col-form-label"},n(e.$t("map.image-url")),9,js),o("div",Js,[w(o("input",{type:"text",name:"image",id:`${a.uid}-image`,"onUpdate:modelValue":t[7]||(t[7]=p=>a.createEditNodeModel.image=p),class:"form-control"},null,8,Qs),[[R,a.createEditNodeModel.image]]),o("small",Ws,n(e.$t("map.image-url-note")),1)])])])):f("",!0)]),o("div",Ks,[o("h3",null,n(e.$t("map.notes")),1),o("div",Ys,[(r(!0),c(b,null,M(a.createEditNodeModel.notes,(p,S)=>(r(),c("div",{key:p.type,class:C(["note",p.type])},[o("div",xs,[o("div",Xs,[S!==0?(r(),c("div",ea,[o("button",{class:"btn btn-block btn-light move-arrow",onClick:O=>s.modifyNote("UP",S)},[d(u,{name:"fa6-solid:arrow-up"}),g(" Move Up ")],8,ta)])):f("",!0),S!==a.createEditNodeModel.notes.length-1?(r(),c("div",oa,[o("button",{class:"btn btn-block btn-light move-arrow",onClick:O=>s.modifyNote("DOWN",S)},[d(u,{name:"fa6-solid:arrow-down"}),g(" Move Down ")],8,ia)])):f("",!0),o("div",sa,[o("button",{class:"btn btn-block btn-danger delete-button",onClick:O=>s.modifyNote("DELETE",S)},[d(u,{name:"fa6-solid:trash"}),g(" Remove ")],8,aa)])]),o("div",na,[o("div",ra,[o("label",la,n(e.$t("map.type")),1),o("div",da,[w(o("select",{"onUpdate:modelValue":O=>p.type=O,class:"form-select",name:"note-type[]"},[o("option",ua,n(e.$t("map.requirement")),1),o("option",ma,n(e.$t("map.warning")),1),o("option",ha,n(e.$t("map.information")),1),o("option",ga,n(e.$t("map.description")),1)],8,ca),[[Z,p.type]])])]),o("div",pa,[o("label",_a,n(e.$t("map.text")),1),o("div",fa,[w(o("textarea",{name:"note-text[]","onUpdate:modelValue":O=>p.text=O,class:"form-control"},null,8,va),[[R,p.text]])])])])])],2))),128))]),o("div",ya,[o("div",ba,[o("button",{type:"button",onClick:t[8]||(t[8]=p=>a.createEditNodeModel.notes.push({})),id:"add-note-button",class:"btn btn-dark"},[d(u,{name:"fa6-solid:circle-plus"}),g(" "+n(e.$t("map.add-another-note")),1)])])]),o("h3",null,n(e.$t("map.mission-variants")),1),(r(!0),c(b,null,M(i.mission.variants,p=>(r(),c("div",$a,[o("div",ka,[w(o("input",{class:"form-check-input",type:"checkbox",id:`${a.uid}-variant-${p.id}`,value:p.id,"onUpdate:modelValue":t[9]||(t[9]=S=>a.createEditNodeModel.variantIds=S)},null,8,wa),[[ke,a.createEditNodeModel.variantIds]]),o("label",{class:"form-check-label",for:`${a.uid}-variant-${p.id}`},n(p.name),9,Ea)])]))),256))])])]),_:1},8,["modal-title"])}const Ca=k(ns,[["render",Ma],["__scopeId","data-v-2594fb4d"]]);const Ia={name:"DeleteEntityModal",components:{GameIcon:D,GameButton:F,Modal:A},props:{entity:Object,entityType:String},data(){return{deleteButtonBlocked:!1}},setup(){return{apiDomain:P().public.apiDomain}},computed:{modalTitle(){let e=this.entityType[0].toUpperCase()+this.entityType.substr(1).toLowerCase();return this.entityType==="disguise-area"&&(e="Disguise Area"),this.$t("map.confirm-item-deletion-title",{item:e})},displayEntityType(){return this.entityType.replace("-"," ")}},methods:{doDelete(){this.deleteButtonBlocked=!0;const e=this.entityType==="foliage"?this.entityType:`${this.entityType}s`;T(`${this.apiDomain}/api/${e}/${this.entity.id}`,{method:"DELETE"}).then(t=>{this.deleteButtonBlocked=!1,this.$toastr.s(`Successfully deleted ${this.entityType}!`),this.$emit("item-deleted")}).catch(t=>{this.deleteButtonBlocked=!1,this.$toastr.e(`Failed to delete ${this.entityType}!`)})},showModal(){this.$refs.innerModal.showModal()},hideModal(){this.$refs.innerModal.hideModal()}}},Da={class:"delete"};function Na(e,t,i,m,a,s){const l=j("i18n-t"),u=D,h=F,_=A;return i.entity&&i.entityType?(r(),y(_,{key:0,id:"delete-entity","modal-title":s.modalTitle,ref:"innerModal"},{"modal-footer":v(()=>[d(h,{type:"button","data-dismiss":"modal"},{default:v(()=>[d(u,{icon:"failed","font-style":"normal"}),g(" "+n(e.$t("form.cancel")),1)]),_:1}),o("span",Da,[d(h,{type:"submit",onClick:s.doDelete,disabled:a.deleteButtonBlocked},{default:v(()=>[d(u,{icon:"arrow-right","font-style":"normal"}),g(" "+n(e.$t("map.delete")),1)]),_:1},8,["onClick","disabled"])])]),default:v(()=>[d(l,{keypath:"map.confirm-item-deletion-message",tag:"p"},{item:v(()=>[g(n(s.displayEntityType),1)]),_:1})]),_:1},8,["modal-title"])):f("",!0)}const La=k(Ia,[["render",Na],["__scopeId","data-v-94630160"]]);const Sa={name:"ManageDisguiseAreaModal",components:{GameIcon:D,GameButton:F,Modal:A},props:{entity:Object},data(){return{operationInProgress:!1}},setup(){return{apiDomain:P().public.apiDomain}},computed:{modalTitle(){return this.$t("map.manage-disguise-area")},convertToMessage(){const e=this.entity.type==="trespassing"?"hostile-area":"trespassing";return this.$t("map.convert-to-x",{type:this.$t(`map.${e}`)})}},methods:{doDelete(){this.operationInProgress=!0,T(`${this.apiDomain}/api/disguise-areas/${this.entity.id}`,{method:"DELETE"}).then(e=>{this.operationInProgress=!1,this.$toastr.s("Successfully deleted disguise area!"),this.$emit("item-deleted")}).catch(e=>{this.operationInProgress=!1,this.$toastr.e("Failed to delete disguise area!")})},doConvert(){this.operationInProgress=!0,T(`${this.apiDomain}/api/disguise-areas/${this.entity.id}/convert`,{method:"PATCH"}).then(e=>{this.operationInProgress=!1,this.$toastr.s("Successfully converted disguise area!"),this.$emit("item-converted")}).catch(e=>{this.operationInProgress=!1,this.$toastr.e("Failed to convert disguise area!")})},showModal(){this.$refs.innerModal.showModal()},hideModal(){this.$refs.innerModal.hideModal()}}},Ta={class:"delete"};function Aa(e,t,i,m,a,s){const l=D,u=F,h=A;return i.entity?(r(),y(h,{key:0,id:"manage-disguise-area-modal","modal-title":s.modalTitle,ref:"innerModal"},{"modal-footer":v(()=>[d(u,{type:"button","data-dismiss":"modal",onClick:s.hideModal},{default:v(()=>[d(l,{icon:"failed","font-style":"normal"}),g(" "+n(e.$t("form.cancel")),1)]),_:1},8,["onClick"]),d(u,{type:"button",onClick:s.doConvert,disabled:a.operationInProgress},{default:v(()=>[d(l,{icon:"reset","font-style":"normal"}),g(" "+n(s.convertToMessage),1)]),_:1},8,["onClick","disabled"]),o("span",Ta,[d(u,{type:"button",onClick:s.doDelete,disabled:a.operationInProgress},{default:v(()=>[d(l,{icon:"arrow-right","font-style":"normal"}),g(" "+n(e.$t("map.delete")),1)]),_:1},8,["onClick","disabled"])])]),_:1},8,["modal-title"])):f("",!0)}const Fa=k(Sa,[["render",Aa],["__scopeId","data-v-8babf709"]]),Oa={name:"MoveNodeModal",components:{GameIcon:D,GameButton:F,Modal:A},props:{node:Object},setup(){return{apiDomain:P().public.apiDomain}},methods:{cancelMoveMarker(){this.node.marker.setLatLng([this.node.latitude,this.node.longitude]),this.hideModal()},confirmMove(){T(`${this.apiDomain}/api/nodes/${this.node.id}`,{method:"PATCH",body:{latitude:this.node.marker.getLatLng().lat,longitude:this.node.marker.getLatLng().lng}}).then(e=>{this.$toastr.s("Item moved!"),this.node.latitude=this.node.marker.getLatLng().lat,this.node.longitude=this.node.marker.getLatLng().lng,this.hideModal()}).catch(e=>{console.error(e),this.$toastr.e("Error occurred when moving item!"),this.node.marker.setLatLng([this.node.latitude,this.node.longitude]),this.hideModal()})},showModal(){this.$refs.innerModal.showModal()},hideModal(){this.$refs.innerModal.hideModal()}}};function Va(e,t,i,m,a,s){const l=D,u=F,h=A;return r(),y(h,{"modal-title":e.$t("map.confirm-move"),id:"confirm-move-modal",tabindex:"-1",ref:"innerModal",role:"dialog",dismissable:""},{"modal-footer":v(()=>[d(u,{type:"button",onClick:s.cancelMoveMarker,"data-dismiss":"modal"},{default:v(()=>[d(l,{icon:"failed","font-style":"normal"}),g(" "+n(e.$t("form.cancel")),1)]),_:1},8,["onClick"]),d(u,{type:"submit",onClick:s.confirmMove},{default:v(()=>[d(l,{icon:"check","font-style":"normal"}),g(" "+n(e.$t("form.save")),1)]),_:1},8,["onClick"])]),default:v(()=>[g(n(e.$t("map.confirm-reposition"))+" ",1)]),_:1},8,["modal-title"])}const Ra=k(Oa,[["render",Va]]);const Pa=we({name:"[mission].vue",setup(){const e=P(),t=Ee(),i=U(`${e.public.apiDomain}/api/v1/games/${t.params.game}`,"$QReHYxKdsy"),m=U(`${e.public.apiDomain}/api/v1/games/${t.params.game}/locations/${t.params.location}/missions/${t.params.mission}`,"$E4UBfdX75M");return m.then(a=>{const s=`${e.public.apiDomain}/api/v1/games/${t.params.game}/locations/${t.params.location}/missions/${t.params.mission}/ogimage`,l=a.data.value[0].name;Me({title:l,ogTitle:K.siteTitle(l),ogImage:s,twitterImage:s,description:`View item locations, disguises, and more for ${l}`,ogDescription:`View item locations, disguises, and more for ${l}`,twitterDescription:`View item locations, disguises, and more for ${l}`})}),{gamePromise:i,missionPromise:m,apiDomain:e.public.apiDomain}},mounted(){const e=this.$config;this.gamePromise.then(t=>{this.game=t.data.value[0]}),this.missionPromise.then(t=>{this.mission=t.data.value[0],this.currentFloor=this.mission.startingFloorNumber,this.currentVariant=this.$route.query.variant?this.mission.variants.find(i=>i.slug===this.$route.query.variant):this.mission.variants.find(i=>i.default)}),Promise.all([this.gamePromise,this.missionPromise]).then(t=>{this.metadataLoaded=!0;const i=U(`${e.public.apiDomain}/api/v2/games/${this.$route.params.game}/locations/${this.$route.params.location}/missions/${this.$route.params.mission}/nodes`,{lazy:!0,server:!1},"$ISoNLVYyc6").then(l=>{this.topLevelCategories=l.data.value.topLevelCategories,this.nodes=l.data.value.nodes,this.nodes.forEach(u=>{this.buildNodeForMap(u)}),this.categories=l.data.value.categories,this.mapLayers=this.buildMapLayers(),this.$nextTick(()=>{this.map=L.map("map",{maxZoom:this.mission.maxZoom,minZoom:this.mission.minZoom,crs:L.CRS.Simple,renderer:this.mission.svg?L.svg():L.canvas(),maxBounds:this.mapBounds,layers:Object.values(this.mapLayers)}).setView(L.latLng(this.mission.mapCenterLatitude,this.mission.mapCenterLongitude),this.mission.minZoom),this.nodes.forEach(u=>u.marker.addTo(this.map))})}),m=U(`${e.public.apiDomain}/api/v2/games/${this.$route.params.game}/locations/${this.$route.params.location}/missions/${this.$route.params.mission}/disguises`,{lazy:!0,server:!1},"$rhxQdtIeQP").then(l=>this.disguises=l.data.value.disguises),a=U(`${e.public.apiDomain}/api/v2/games/${this.$route.params.game}/locations/${this.$route.params.location}/missions/${this.$route.params.mission}/ledges`,{lazy:!0,server:!1},"$DACdteTkLz").then(l=>{this.ledges=l.data.value.ledges,this.ledges.forEach(u=>this.buildLedgeForMap(u)),this.$nextTick(u=>this.ledges.forEach(h=>h.polyline.addTo(this.map)))}),s=U(`${e.public.apiDomain}/api/v2/games/${this.$route.params.game}/locations/${this.$route.params.location}/missions/${this.$route.params.mission}/foliage`,{lazy:!0,server:!1},"$NJn2xPebBe").then(l=>{this.foliage=l.data.value.foliage,this.foliage.forEach(u=>this.buildFoliageForMap(u)),this.$nextTick(u=>this.foliage.forEach(h=>h.polygon.addTo(this.map)))});Promise.all([i,m,a,s]).then(l=>{this.$nextTick(()=>{this.updateActiveMapState(),this.mapDataLoaded=!0,this.map.on("click",this.addMarker),this.map.on("pm:drawstart",this.initDraw),this.map.on("pm:create",this.pmLayer),this.map.on("pm:drawend",this.endDraw),this.map.on("zoomend",()=>{let u=this.map.getZoom();const h={3:".8em",4:"1em",5:"1.2em"};$(".area-icon").css("font-size",h[u])})})})})},data(){return{metadataLoaded:!1,mapDataLoaded:!1,game:null,mission:null,nodes:[],categories:[],topLevelCategories:[],disguises:[],disguiseAreas:{},ledges:[],foliage:[],currentFloor:0,map:null,mapLayers:{},nodeForModal:null,nodeForEditing:null,nodeForMoving:null,clickedPoint:null,vertices:[],workingLayer:null,currentDisguise:null,currentVariant:null,editorState:"OFF",disguiseRegionType:null,polyActive:!1,deletionItem:null,deletionItemType:null}},methods:{buildNodeForMap(e){e.latLng=L.latLng(e.latitude,e.longitude),e.visible=!0,e.searchResult=!1,e.marker=new L.marker([e.latitude,e.longitude],{icon:this.buildIcon(e),custom:{id:e.id},riseOnHover:!0}).on("click",t=>{this.renderItemDetailsModal(e)}).on("dragend",t=>{this.nodeForMoving=e,this.$refs.moveNodeModal.showModal()}),this.bindTooltip(e)},buildLedgeForMap(e){e.visible=!0;const t=e.vertices.map(i=>[i.split(",")[0],i.split(",")[1]]);return e.polyline=L.polyline(t,{color:"#fff",weight:4,opacity:.75,custom:{id:e.id}}).bindTooltip(this.$t("map.groups.Navigation|Ledge"),{sticky:!0}).on("click",()=>this.displayConfirmPolyDeletionModal(e,"ledge")),e},displayConfirmPolyDeletionModal(e,t){if(this.editorState==="LEDGES"&&t==="ledge"||this.editorState==="FOLIAGE"&&t==="foliage"||this.editorState==="DISGUISE-REGIONS"&&t==="disguise-area"){if(this.editorState==="LEDGES")this.deletionItemType="ledge";else if(this.editorState==="FOLIAGE")this.deletionItemType="foliage";else if(this.editorState==="DISGUISE-REGIONS")this.deletionItemType="disguise-area";else return;this.deletionItem=e,this.editorState==="DISGUISE-REGIONS"?this.$nextTick(()=>this.$refs.manageDisguiseAreaModal.showModal()):this.$nextTick(()=>this.$refs.deleteEntityModal.showModal())}},buildFoliageForMap(e){e.visible=!0;const t=e.vertices.map(i=>[i.split(",")[0],i.split(",")[1]]);return e.polygon=L.polygon(t,{color:"#248f24",weight:4,opacity:.75,custom:{id:e.id}}).bindTooltip(this.$t("map.groups.Navigation|Foliage"),{sticky:!0}).on("click",()=>this.displayConfirmPolyDeletionModal(e,"foliage")),e},buildDisguiseAreaForMap(e){const t=e.vertices.map(i=>[i.split(",")[0],i.split(",")[1]]);return e.polygon=L.polygon(t,{color:e.type==="trespassing"?"yellow":"#f00",stroke:!1,weight:4,opacity:.75}).bindTooltip(e.type==="trespassing"?this.$t("map.trespassing"):this.$t("map.hostile-area"),{sticky:!0}).on("click",()=>this.displayConfirmPolyDeletionModal(e,"disguise-area")),e},buildMapLayers(){const e={};if(this.mission.svg||(e[0]=L.tileLayer(this.imageTileUrl.replace("{floorNumber}","0"),{noWrap:!0,minZoom:this.mission.minZoom,maxZoom:this.mission.maxZoom})),this.mission.svg)for(let t=this.mission.lowestFloorNumber;t<=this.mission.highestFloorNumber;t++)e[t]=L.imageOverlay(`${this.svgMapUrl}${t}.svg`,this.layerBounds);return this.mission.satelliteView&&(e[-99]=L.tileLayer(this.imageTileUrl.replace("{floorNumber}","-99"),{noWrap:!0,minZoom:this.mission.minZoom,maxZoom:this.mission.maxZoom})),e},updateActiveMapState(){this.updateActiveMapLayer(),this.updateActiveDisguiseLayer(),this.updateNodeMarkers()},updateActiveMapLayer(){this.range(this.mission.lowestFloorNumber,this.mission.highestFloorNumber).forEach(e=>this.map.removeLayer(this.mapLayers[e])),this.map.addLayer(this.mapLayers[this.currentFloor])},updateActiveDisguiseLayer(e){e&&this.disguiseAreas[e.id].forEach(t=>t.polygon.removeFrom(this.map)),this.currentDisguise&&(this.disguiseAreas[this.currentDisguise.id].forEach(t=>t.polygon.removeFrom(this.map)),this.disguiseAreas[this.currentDisguise.id].filter(t=>t.level===this.currentFloor).forEach(t=>t.polygon.addTo(this.map)))},updateNodeMarkers(){this.nodes.forEach(e=>e.marker._icon.style.display="none"),this.ledges.forEach(e=>e.polyline.removeFrom(this.map)),this.foliage.forEach(e=>e.polygon.removeFrom(this.map)),this.nodes.filter(e=>e.searchResult).forEach(e=>e.visible=!0),this.nodes.filter(e=>e.level===this.currentFloor&&e.visible&&e.variants.includes(this.currentVariant.id)).forEach(e=>{e.marker._icon.style.display="block",e.searchResult?e.marker._icon.classList.add("search-result"):e.marker._icon.classList.remove("search-result")}),this.ledges.filter(e=>e.level===this.currentFloor&&e.visible).forEach(e=>e.polyline.addTo(this.map)),this.foliage.filter(e=>e.level===this.currentFloor&&e.visible).forEach(e=>e.polygon.addTo(this.map)),this.$refs.floorToggle&&this.$refs.floorToggle.$forceUpdate(),this.$refs.sidebar&&this.$refs.sidebar.$forceUpdate()},buildIcon(e){return e.icon==="area"?new L.DivIcon({className:"area-icon",html:e.name.replace(/(?:\r\n|\r|\n)/g,"<br>")}):L.icon({iconUrl:`/img/map-icons/${e.icon}.png`,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,0]})},bindTooltip(e){let t=e.name!==""?e.name:"";switch(e.subgroup){case"up-stair":t=this.$t("map.groups.Navigation|Stairwell");break;case"blend-in":t=e.name==="Any Disguise"?this.$t("map.groups.Points of Interest|Blend In"):this.$t("map.blend-in-as",{disguiseName:e.name});break;case"locked-door":case"conceal-item":case"hiding-spot":case"destroy-evidence":case"weapon-crate":case"camera":case"frisk":t=e.group;break;case"area":t="";break}t!==""&&(e.quantity>1&&(t+=` (x${e.quantity})`),e.marker.bindTooltip(t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")))},renderItemDetailsModal(e){this.nodeForModal=e,this.$refs.nodePopup.resetDeletionState(),this.$nextTick(()=>{this.$refs.nodePopup.showModal()})},addMarker(e){this.editorState==="ITEMS"&&(this.nodeForEditing=null,this.clickedPoint=e.latlng,this.$nextTick(t=>{this.$refs.addEditItemModal.initializeAddEditModal(),this.$refs.addEditItemModal.showModal()}))},prepareEditor(e){this.nodeForEditing=this.nodes.find(t=>t.id===e),this.$refs.addEditItemModal.initializeAddEditModal(),this.$nextTick(t=>{this.$refs.addEditItemModal.initializeAddEditModal(),this.$refs.addEditItemModal.showModal()})},deleteNode(e){const t=this.nodes.find(i=>i.id===e);t.marker.removeFrom(this.map),V.deleteElement(this.nodes,t)},onItemCreated(e){this.nodes.push(e),this.buildNodeForMap(e),e.marker.addTo(this.map),e.marker.dragging.enable(),this.updateNodeMarkers(),this.$refs.addEditItemModal.hideModal()},onItemUpdated(e){this.nodeForEditing.marker.removeFrom(this.map),V.deleteElement(this.nodes,this.nodeForEditing),this.nodes.push(e),this.buildNodeForMap(e),e.marker.addTo(this.map),this.updateNodeMarkers(),this.$refs.addEditItemModal.hideModal()},range(e,t){return K.range(e,t)},onChangeFloor(e){this.currentFloor=e},onHideAll(){this.nodes.forEach(e=>e.visible=!1),this.ledges.forEach(e=>e.visible=!1),this.foliage.forEach(e=>e.visible=!1),this.updateActiveMapState()},onShowAll(){this.nodes.forEach(e=>e.visible=!0),this.ledges.forEach(e=>e.visible=!0),this.foliage.forEach(e=>e.visible=!0),this.updateActiveMapState()},onSearchItem(e){if(this.nodes.forEach(t=>t.searchResult=!1),e!==null){const t=e.split("|");this.nodes.filter(i=>i.group===t[0]&&i.name===t[1]).forEach(i=>i.searchResult=!0)}this.updateNodeMarkers()},onHideCategory(e){e.subgroup==="ledge"?this.ledges.forEach(t=>t.visible=!1):e.subgroup==="foliage"?this.foliage.forEach(t=>t.visible=!1):this.nodes.filter(t=>t.type===e.type&&t.group===e.group).forEach(t=>t.visible=!1),this.updateNodeMarkers()},onShowCategory(e){e.subgroup==="ledge"?this.ledges.forEach(t=>t.visible=!0):e.subgroup==="foliage"?this.foliage.forEach(t=>t.visible=!0):this.nodes.filter(t=>t.type===e.type&&t.group===e.group).forEach(t=>t.visible=!0),this.updateNodeMarkers()},onHideTopLevelCategory(e){this.nodes.filter(t=>t.type===e).forEach(t=>t.visible=!1),e==="Navigation"&&(this.ledges.forEach(t=>t.visible=!1),this.foliage.forEach(t=>t.visible=!1)),this.updateNodeMarkers()},onShowTopLevelCategory(e){this.nodes.filter(t=>t.type===e).forEach(t=>t.visible=!0),e==="Navigation"&&(this.ledges.forEach(t=>t.visible=!0),this.foliage.forEach(t=>t.visible=!0)),this.updateNodeMarkers()},onZoomIn(){this.map.setZoom(this.map.getZoom()+1)},onZoomOut(){this.map.setZoom(this.map.getZoom()-1)},onMasterEditToggle(){this.editorState==="OFF"?this.editorState="MENU":(this.editorState="OFF",this.toggleDraw("OFF"),this.nodes.forEach(e=>e.marker.dragging.disable()))},onLaunchEditor(e){this.editorState=e,this.editorState==="MENU"&&this.toggleDraw("OFF"),this.editorState==="ITEMS"?this.nodes.forEach(t=>t.marker.dragging.enable()):this.nodes.forEach(t=>t.marker.dragging.disable())},toggleDraw(e){if(e==="OFF"){this.map.pm.disableDraw("Line"),this.map.pm.disableDraw("Polygon");return}this.map.pm.Draw[e]._enabled?(this.map.pm.disableDraw(e),this.polyActive=!1):(this.map.pm.enableDraw(e,{snappable:!1}),this.polyActive=!0);let t=this.polyActive?"Drawing tools enabled":"Drawing tools disabled";this.$toastr.i(t)},onEnableLedgeCreation(){this.toggleDraw("Line")},onEnableFoliageCreation(){this.toggleDraw("Polygon")},onEnableDisguiseRegionCreation(e){this.disguiseRegionType!==null&&this.disguiseRegionType!==e&&this.toggleDraw("Polygon"),this.disguiseRegionType!==null&&this.disguiseRegionType===e?this.disguiseRegionType=null:this.disguiseRegionType=e,this.toggleDraw("Polygon")},initDraw(e){e.workingLayer.on("pm:vertexadded",t=>{this.vertices.push([t.latlng.lat,t.latlng.lng])})},pmLayer(e){this.workingLayer=e.layer},endDraw(e){if(this.vertices.length===0)return;const t={vertices:[],missionId:this.mission.id,level:this.currentFloor};this.vertices.forEach(i=>{t.vertices.push(`${i[0]},${i[1]}`)}),e.shape==="Line"?T(`${this.apiDomain}/api/ledges`,{method:"POST",body:t}).then(i=>{this.vertices=[],this.ledges.push(this.buildLedgeForMap(JSON.parse(i.data.value).data)),this.$toastr.s("Ledge saved!"),this.map.removeLayer(this.workingLayer),this.workingLayer=null,this.polyActive=!1,this.updateNodeMarkers()}).catch(i=>{this.$toastr.e("Error occurred when saving ledge!")}):this.editorState==="FOLIAGE"?T(`${this.apiDomain}/api/foliage`,{method:"POST",body:t}).then(i=>{this.vertices=[],this.foliage.push(this.buildFoliageForMap(JSON.parse(i.data.value).data)),this.$toastr.s("Foliage saved!"),this.map.removeLayer(this.workingLayer),this.workingLayer=null,this.polyActive=!1,this.updateNodeMarkers()}).catch(i=>{this.$toastr.e("Error occurred when saving foliage!")}):this.editorState==="DISGUISE-REGIONS"&&(t.disguiseId=this.currentDisguise.id,t.type=this.disguiseRegionType,T(`${this.apiDomain}/api/disguise-areas`,{method:"POST",body:t}).then(i=>{this.vertices=[],this.disguiseAreas[this.currentDisguise.id].push(this.buildDisguiseAreaForMap(JSON.parse(i.data.value).data)),this.$toastr.s("Disguise area saved!"),this.map.removeLayer(this.workingLayer),this.workingLayer=null,this.polyActive=!1,this.disguiseRegionType=null,this.updateActiveDisguiseLayer()}).catch(i=>{console.error(i),this.$toastr.e("Error occurred when saving disguise area!")}))},onPolyDeleted(){this.deletionItemType==="ledge"?(this.deletionItem.polyline.removeFrom(this.map),V.deleteElement(this.ledges,this.deletionItem)):this.deletionItemType==="foliage"?(this.deletionItem.polygon.removeFrom(this.map),V.deleteElement(this.foliage,this.deletionItem)):this.deletionItemType==="disguise-area"&&(this.deletionItem.polygon.removeFrom(this.map),V.deleteElement(this.disguiseAreas[this.currentDisguise.id],this.deletionItem)),this.deletionItemType=null,this.deletionItem=null,this.updateNodeMarkers(),this.$refs.deleteEntityModal.hideModal(),this.$refs.manageDisguiseAreaModal.hideModal()},onDisguiseAreaConverted(){this.deletionItem.polygon.removeFrom(this.map),this.deletionItem.type=this.deletionItem.type==="trespassing"?"hostile":"trespassing",this.disguiseAreas[this.currentDisguise.id].push(this.buildDisguiseAreaForMap(this.deletionItem)),this.deletionItemType=null,this.deletionItem=null,this.updateNodeMarkers(),this.updateActiveDisguiseLayer(),this.$refs.manageDisguiseAreaModal.hideModal()},onDisguiseSelected(e){if(this.disguiseRegionType&&this.onEnableDisguiseRegionCreation(this.disguiseRegionType),e==="NONE"||this.disguiseAreas[e.id]){this.currentDisguise=e==="NONE"?null:e;return}T(`${this.apiDomain}/api/v2/games/${this.$route.params.game}/locations/${this.$route.params.location}/missions/${this.$route.params.mission}/disguise-areas/${e.id}`).then(t=>{this.disguiseAreas[e.id]=t.data.value.disguiseAreas,this.disguiseAreas[e.id].forEach(i=>this.buildDisguiseAreaForMap(i)),this.currentDisguise=e}).catch(t=>{console.error(t),this.$toastr.e("Failed to retrieve disguise regions!")})},onReplaceDisguiseAreas(e){if(!e.length)return;const t=e[0].disguiseId;this.disguiseAreas[t].forEach(i=>i.polygon.removeFrom(this.map)),this.disguiseAreas[t]=e,this.disguiseAreas[t].forEach(i=>this.buildDisguiseAreaForMap(i)),this.updateActiveDisguiseLayer()},onVariantSelected(e){this.currentVariant=e,this.updateActiveMapState()}},computed:{mapBounds(){return[this.mission.topLeftCoordinate.split(","),this.mission.bottomRightCoordinate.split(",")]},layerBounds(){return[this.mission.boundingBoxTopLeft.split(","),this.mission.boundingBoxBottomRight.split(",")]},showDebug(){return{}.VITE_SHOW_DEBUG==="true"},svgMapUrl(){return this.game===void 0||this.mission===void 0?"":`https://media.hitmaps.com/img/${this.game.slug}/maps/${this.mission.mapFolderName}/`},imageTileUrl(){return this.mission?`https://legacyapi.hitmaps.com/api/maps/${this.mission.mapFolderName}/tiles/{floorNumber}/{z}/{x}/{y}.png`:""},loggedIn(){if(localStorage.getItem("token")!=null){var e=JSON.parse(atob(localStorage.getItem("token").split(".")[1])),t=new Date;if(new Date(e.exp*1e3).getTime()-t.getTime()>0)return!0}return!1}},watch:{currentFloor(){this.map&&this.updateActiveMapState()},currentDisguise(e,t){this.map&&this.updateActiveDisguiseLayer(t)}}});function Ua(e,t,i,m,a,s){const l=Pe,u=Je,h=Mi,_=Zi,E=Ca,p=La,S=Fa,O=Ra,Q=Ce;return r(),c(b,null,[e.metadataLoaded&&!e.mapDataLoaded?(r(),y(l,{key:0,mission:e.mission},null,8,["mission"])):f("",!0),d(Q,null,{default:v(()=>[o("div",null,[e.metadataLoaded&&e.mapDataLoaded?(r(),y(u,{key:0,ref:"floorToggle",mission:e.mission,"current-floor":e.currentFloor,nodes:e.nodes,"current-variant":e.currentVariant,onChangeFloor:e.onChangeFloor},null,8,["mission","current-floor","nodes","current-variant","onChangeFloor"])):f("",!0),o("div",{class:C(`hm-editor-${e.editorState.toLowerCase()}`),id:"map"},null,2),e.metadataLoaded&&e.mapDataLoaded?(r(),y(h,{key:1,ref:"sidebar",game:e.game,mission:e.mission,"logged-in":e.loggedIn,"top-level-categories":e.topLevelCategories,categories:e.categories,nodes:e.nodes,ledges:e.ledges,foliage:e.foliage,disguises:e.disguises,"max-zoom-level":e.mission.maxZoom,"min-zoom-level":e.mission.minZoom,"current-zoom-level":e.map.getZoom(),"editor-state":e.editorState,"drawing-active":e.polyActive,"current-disguise":e.currentDisguise,"current-variant":e.currentVariant,onHideAll:e.onHideAll,onShowAll:e.onShowAll,onSearchItem:e.onSearchItem,onHideCategory:e.onHideCategory,onShowCategory:e.onShowCategory,onHideTopLevelCategory:e.onHideTopLevelCategory,onShowTopLevelCategory:e.onShowTopLevelCategory,onZoomIn:e.onZoomIn,onZoomOut:e.onZoomOut,onMasterEditToggle:e.onMasterEditToggle,onLaunchEditor:e.onLaunchEditor,onEnableLedgeCreation:e.onEnableLedgeCreation,onEnableFoliageCreation:e.onEnableFoliageCreation,onEnableRegionCreation:e.onEnableDisguiseRegionCreation,onDisguiseSelected:e.onDisguiseSelected,onReplaceDisguiseAreas:e.onReplaceDisguiseAreas,onVariantSelected:e.onVariantSelected},null,8,["game","mission","logged-in","top-level-categories","categories","nodes","ledges","foliage","disguises","max-zoom-level","min-zoom-level","current-zoom-level","editor-state","drawing-active","current-disguise","current-variant","onHideAll","onShowAll","onSearchItem","onHideCategory","onShowCategory","onHideTopLevelCategory","onShowTopLevelCategory","onZoomIn","onZoomOut","onMasterEditToggle","onLaunchEditor","onEnableLedgeCreation","onEnableFoliageCreation","onEnableRegionCreation","onDisguiseSelected","onReplaceDisguiseAreas","onVariantSelected"])):f("",!0),d(_,{node:e.nodeForModal,"logged-in":e.loggedIn,game:e.game,"editor-state":e.editorState,ref:"nodePopup",onDeleteNode:e.deleteNode,onEditNode:e.prepareEditor},null,8,["node","logged-in","game","editor-state","onDeleteNode","onEditNode"]),e.mission?(r(),y(E,{key:2,ref:"addEditItemModal","top-level-categories":e.topLevelCategories,categories:e.categories,"clicked-point":e.clickedPoint,"current-level":e.currentFloor,node:e.nodeForEditing,mission:e.mission,onItemCreated:e.onItemCreated,onItemUpdated:e.onItemUpdated},null,8,["top-level-categories","categories","clicked-point","current-level","node","mission","onItemCreated","onItemUpdated"])):f("",!0),d(p,{ref:"deleteEntityModal",entity:e.deletionItem,"entity-type":e.deletionItemType,onItemDeleted:e.onPolyDeleted},null,8,["entity","entity-type","onItemDeleted"]),d(S,{ref:"manageDisguiseAreaModal",entity:e.deletionItem,onItemDeleted:e.onPolyDeleted,onItemConverted:e.onDisguiseAreaConverted},null,8,["entity","onItemDeleted","onItemConverted"]),d(O,{ref:"moveNodeModal",node:e.nodeForMoving},null,8,["node"])])]),_:1})],64)}const Wa=k(Pa,[["render",Ua],["__scopeId","data-v-c318c1cb"]]);export{Wa as default};
